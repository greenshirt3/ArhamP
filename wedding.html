<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Arham Printers - Custom Wedding Invitation Cards</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Custom Wedding Cards, Wedding Invitation Design, Printing Services" name="keywords">
    <meta content="Explore the full range of custom wedding card designs with bulk pricing from Arham Printers." name="description">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    
    <style>
        /* General Layout and Utility Styles */
        :root {
            --bs-primary: #f28b00; /* Assuming this is your primary color */
            --bs-secondary: #ff5722; /* Example secondary color */
            --bs-dark: #212529;
            --mobile-nav-height: 60px;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .final-price-box {
            background: var(--bs-primary);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            text-align: center;
            display: none; 
        }
        .final-price-box h4 {
            color: white;
        }
        
        /* ---------------------------------------------------- */
        /* RESPONSIVE HEADER IMAGE IMPLEMENTATION (NEW LOGIC) */
        /* ---------------------------------------------------- */
        .page-header {
            /* Default: Use Mobile Image (Mobile First Approach) */
            background: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0)), url(img/banners/weddingmobile.webp) center center no-repeat;
            background-size: cover;
            min-height: 250px;
        }

        @media (min-width: 768px) {
            .page-header {
                /* Override: Use Desktop Image on larger screens */
                background: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0)), url(img/banners/weddingdesktop.webp) center center no-repeat;
                background-size: cover;
                min-height: 350px;
            }
        }
        /* ---------------------------------------------------- */
        
        /* --- DESKTOP NAV FIX --- */
        /* Remove margin from h1 inside the desktop navbar brand for alignment */
        .navbar-brand h1 {
            margin-top: 0;
            margin-bottom: 0;
        }

        /* Clickable Card Variations (Standard Items) */
        .choice-card {
            cursor: pointer;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px 15px;
            text-align: center;
            transition: all 0.2s ease;
            flex-grow: 1;
            min-width: 120px;
            opacity: 1; /* Default to visible */
        }
        .choice-card:hover {
            border-color: var(--bs-secondary);
            background-color: #fff8f8;
        }
        .choice-card.selected {
            border-color: var(--bs-primary);
            background-color: var(--bs-primary);
            color: white;
            box-shadow: 0 0 10px rgba(242, 139, 0, 0.3);
        }
        /* Style for visually disabling non-selectable options */
        .choice-card.disabled {
            opacity: 0.5;
            pointer-events: none; /* Disable interaction */
            border-color: #eee;
            background-color: #f7f7f7;
        }
        .choice-card input[type="radio"] {
            display: none;
        }
        .choice-card .label-text {
            font-weight: 500;
            color: var(--bs-dark);
            display: block;
        }
        .choice-card.selected .label-text {
            color: white;
        }
        .product-option-group {
            margin-bottom: 1.5rem;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .product-option-group label {
            font-weight: 600;
            color: var(--bs-dark);
            margin-bottom: 0.75rem;
            display: block;
            font-size: 1.1rem;
        }

        /* --- MOBILE BOTTOM NAVIGATION STYLES --- */

        /* 1. Mobile Bottom Bar Container */
        #mobile-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--mobile-nav-height);
            background: white;
            border-top: 1px solid #ddd;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
            z-index: 1030;
            display: flex;
            align-items: center;
            justify-content: space-around;
        }
        
        /* **FIX 1: Ensure all 5 top-level elements take equal width** */
        #mobile-bottom-nav > a, 
        #mobile-bottom-nav > div {
            flex: 1 1 0%; /* Equal distribution: 20% width per slot */
        }

        /* 2. Mobile Link Styling */
        .mobile-nav-link {
            flex: 1; 
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            text-decoration: none;
            color: var(--bs-dark);
            font-size: 0.6rem; /* Smaller text for compact look */
            padding: 5px 0;
            transition: color 0.2s;
            position: relative;
            height: 100%;
            justify-content: center;
        }
        .mobile-nav-link:hover {
             color: var(--bs-primary);
        }
        .mobile-nav-link i {
            font-size: 1.1rem;
            margin-bottom: 2px;
            line-height: 1;
        }
        .mobile-nav-link.active {
            color: var(--bs-primary);
        }
        

/* Update the existing #mobile-nav-logo section */
/* 3. Center Logo Button */
#mobile-nav-logo {
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  position: relative; /* Make it relative for absolute children */
}
#mobile-nav-logo a {
Â  Â  Â  Â  Â  Â  background-color: var(--bs-primary);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  width: 45px;
Â  Â  Â  Â  Â  Â  height: 45px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px rgba(242, 139, 0, 0.6);
Â  Â  Â  Â  Â  Â  position: absolute; 
Â  Â  Â  Â  Â  Â  top: -15px; 
Â  Â  Â  Â  Â  Â  /* **FIX 2: Center absolutely positioned element within its slot** */
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translateX(-50%); 
}

/* NEW RULE: Style the image inside the centered mobile button */
#mobile-nav-logo a img {
    /* Ensures the image is centered and prevents vertical alignment issues */
    vertical-align: middle; 
    /* Ensures the image doesn't overflow the 45px circle container */
    max-width: 80%; 
    max-height: 80%;
    height: auto !important; /* Overrides inline height if needed, maintaining aspect ratio */
}

#mobile-nav-logo a i {
Â  Â  Â  Â  Â  Â  font-size: 1.5rem;
}
        /* 4. Content Padding to clear the fixed bottom nav */
        #shop-catalog-section, #product-detail-section, #quote-section, #contact-section, #cart-section, #checkout-section {
            padding-bottom: calc(var(--mobile-nav-height) + 15px); /* Add space for the bottom navbar */
        }
        
        /* 5. Compact Category Link Styling (Removed, but keeping class definitions minimal) */
        .categories-item a {
            font-size: 0.75rem; 
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 0;
            line-height: 1.2;
        }
        .categories-item a i {
            font-size: 1.2rem; 
            margin-bottom: 5px !important;
        }
        
        /* 6. Mobile Dropdown Specific Styling */
        #mobile-bottom-nav .dropdown-menu {
            position: absolute;
            bottom: var(--mobile-nav-height); /* Position above the nav bar */
            left: 50%;
            transform: translateX(-50%);
            width: 250px;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
            border-radius: 8px 8px 0 0;
            padding: 10px 0;
        }
        #mobile-bottom-nav .dropdown-item {
             font-size: 0.8rem;
        }
    </style>
</head>

<body>
    <div class="container">
    <div class="container-fluid bg-dark text-white-50 py-2 px-0 d-none d-lg-block">
        <div class="row gx-0 align-items-center">
            <div class="col-lg-7 px-5 text-start">
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="fa fa-phone-alt me-2"></small>
                    <small>+92 300 6238233</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="far fa-envelope-open me-2"></small>
                    <small>info@arhamprinters.pk</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="far fa-clock me-2"></small>
                    <small>Mon - Fri : 09 AM - 09 PM</small>
                </div>
            </div>
            <div class="col-lg-5 px-5 text-end">
                <div class="h-100 d-inline-flex align-items-center">
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-facebook-f"></i></a>
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-twitter"></i></a>
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-linkedin-in"></i></a>
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </div>
    
    <nav class="navbar navbar-expand-lg bg-white navbar-light sticky-top px-4 px-lg-5 d-none d-lg-block">
    
    <div class="d-flex w-100 justify-content-between align-items-center">
        
        <a href="index.html" class="navbar-brand d-flex align-items-center me-4">
            <img src="img/logo2.webp" alt="Arham Printers Logo" style="height: 40px; margin-right: 1rem;">
        </a>
        <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
    
        <div class="collapse navbar-collapse flex-grow-1" id="navbarCollapse">
            <div class="navbar-nav me-auto bg-light pe-4 py-3 py-lg-0 d-flex align-items-center">
                
                <a href="index.html" class="nav-item nav-link">Home</a>
                <a href="products.html" class="nav-item nav-link">Products</a>
                <a href="wedding.html" class="nav-item nav-link active">Wedding Cards</a>
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Shop</a>
                    <div class="dropdown-menu bg-light border-0 m-0">
                        <a href="products.html" class="dropdown-item">All Products</a>
                        <a href="#quote-section" class="dropdown-item" onclick="showSection('quote')">Get Custom Quote</a>
                    </div>
                </div>
                <a href="#contact-section" class="nav-item nav-link" onclick="showSection('contact')">Contact</a>
            </div>
            
            <div class="h-100 d-lg-inline-flex align-items-center">
                <a class="btn-sm-square bg-white text-dark rounded-circle me-4 position-relative" href="#cart-section" onclick="showSection('cart')">
                    <i class="fas fa-shopping-cart"></i>
                    <span id="desktop-cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary" style="font-size: 0.6em; padding: 4px;">0</span>
                </a>
                <a href="#contact-section" class="btn btn-primary py-2 px-3 rounded-0 d-none d-lg-block" onclick="showSection('quote')">Get a Quote<i
                        class="fa fa-arrow-right ms-3"></i></a>
            </div>
        </div>
    </div>
</nav>

    <nav id="mobile-bottom-nav" class="d-lg-none">
    <a href="index.html" class="mobile-nav-link" id="mobile-link-home">
        <i class="fas fa-home"></i>
        <span>Home</span>
    </a>
        <a href="products.html" class="mobile-nav-link" onclick="showSection('shop-catalog')" id="mobile-link-products">
        <i class="fas fa-th-list"></i>
        <span>Products</span>
    </a>
        <div id="mobile-nav-logo">
         <a href="index.html" class="mobile-nav-link-center">
             <img src="img/logo.webp" alt="Logo" style="height: 80px;">
         </a>
    </div>
    <a href="wedding.html" class="mobile-nav-link active" id="mobile-link-wedding">
            <i class="fas fa-gift"></i>
            <span>Wedding Cards</span>
        </a>
    
    
    <a href="#cart-section" class="mobile-nav-link" onclick="showSection('cart')" id="mobile-link-cart">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count" class="position-absolute translate-middle badge rounded-pill bg-primary" style="top: 8px; right: 10px; font-size: 0.7em;">0</span>
        <span>Cart</span>
    </a>
</nav>
    
    <section id="shop-catalog-section" class="section active">
        <div class="container-fluid page-header py-5">
            <h2 class="text-center display-6">Wedding Card Collection</h2>
        </div>

        <div class="container py-5">
            <div class="row g-4 justify-content-center">
                <div class="col-lg-12">
                    <div class="row g-4" id="wedding-card-grid">
                        <div class="col-12 text-center" id="loading-spinner">
                            <div class="spinner-border text-primary" role="status"></div>
                            <p>Loading Card Designs from Database...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="product-detail-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6" id="detail-product-name-header">Card Details</h1>
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="#" onclick="showSection('shop-catalog')">Catalog</a></li>
                <li class="breadcrumb-item active text-white">Details</li>
            </ol>
        </div>

        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-5">
                    <div class="col-lg-6">
                        <div id="cardImageGallery" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-indicators-wrapper" id="carousel-indicators">
                                </div>
                            <div class="carousel-inner" id="carousel-inner">
                                </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#cardImageGallery" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#cardImageGallery" data-bs-slide="next">
                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                <span class="visually-hidden">Next</span>
                            </button>
                        </div>
                        <h4 class="mt-4" id="card-description">Elegant card suitable for all occasions. Custom text available.</h4>
                    </div>
                    
                    <div class="col-lg-6">
                        <h2 class="fw-bold mb-4" id="detail-product-name-body">Card Name</h2>
                        
                        <div id="standard-options-fields">
                            <div class="product-option-group" data-option-key="QuantitySelector">
                                <label>Quantity (Pieces):</label>
                                <div class="input-group">
                                    <button class="btn btn-outline-secondary rounded-0" type="button" onclick="updateQuantityAndPrice(-5)">-5</button>
                                    <input type="number" id="input-card-qty" min="1" value="1" step="1" class="form-control text-center rounded-0" oninput="updateQuantityAndPrice(0)">
                                    <button class="btn btn-outline-secondary rounded-0" type="button" onclick="updateQuantityAndPrice(5)">+5</button>
                                </div>
                                 <small class="text-muted mt-2 d-block" style="display: none;">Minimum order: 1 piece. <span id="fixed-cost-display">*</span></small>
                            </div>
                            
                            <div class="product-option-group" data-option-key="InnerCard" id="inner-card-option-group">
                                <label>Include Extra Inner Card?</label>
                                <div class="d-flex gap-3">
                                    <label class="choice-card-inner" id="inner-yes" onclick="setInnerSelection(true)">
                                        <input type="radio" name="inner-option" value="true">
                                        Yes (Required for this Card Style)
                                    </label>
                                    <label class="choice-card-inner selected" id="inner-no" onclick="setInnerSelection(false)">
                                        <input type="radio" name="inner-option" value="false" checked>
                                        No
                                    </label>
                                </div>
                            </div>

                            <div class="product-option-group mt-4" data-option-key="DeliveryType">
                                <label><i class="fas fa-truck me-2"></i> <strong>Choose Delivery Method:</strong></label>
                                <div class="d-flex flex-wrap gap-3">
                                    <label class="choice-card selected" id="delivery-home" onclick="setDeliveryType('HomeDelivery')">
                                        <input type="radio" name="option-DeliveryType" value="HomeDelivery" checked>
                                        <span class="label-text">Home Delivery</span>
                                    </label>
                                    <label class="choice-card" id="delivery-pickup" onclick="setDeliveryType('SelfPickUp')">
                                        <input type="radio" name="option-DeliveryType" value="SelfPickUp">
                                        <span class="label-text">Self Pick Up (No Shipping)</span>
                                    </label>
                                </div>
                            </div>
                            </div>
                        
                        <div class="product-option-group mt-4" id="shipping-zone-selector">
                            <label><i class="fas fa-map-marker-alt me-2"></i> <strong>Check Delivery Charges:</strong></label>
                            
                            <div class="d-flex gap-2 mb-2">
                                <button class="btn btn-outline-primary w-50 rounded-0" onclick="detectLocation()">
                                    <i class="fas fa-search-location me-2"></i> Auto-Detect My City
                                </button>
                                <input type="text" id="input-city" placeholder="Or Enter Your City Name" class="form-control rounded-0 w-50" oninput="manualLocationCheck()">
                            </div>
                            
                            <small class="text-muted d-block mb-2" id="current-location-display">
                                Current Zone: <span id="zone-name" class="fw-bold text-dark">Not Set (Jalalpur Jattan Default)</span>
                            </small>
                        </div>
                        <div class="final-price-box" id="finalPriceBox">
                            <h4 class="mb-2">Total Price (PKR)</h4>
                            <h3 class="display-6 fw-bold" id="finalPriceDisplay">PKR 0</h3>
                            
                            <div class="alert alert-light mt-3 p-3 rounded-0" id="shipping-display-box" style="display: none;">
                                <h5 class="mb-1 text-success">Shipping: <span id="shipping-cost-display" class="fw-bold text-dark">PKR 0</span></h5>
                                <small id="shipping-note-display" class="d-block text-dark"></small>
                            </div>
                            <button class="btn btn-success py-2 px-4 w-100 mt-3 rounded-0" onclick="addItemToCart()">
                                <i class="fas fa-cart-plus me-2"></i> Add to Cart
                            </button>
                        </div>
                        
                        <div class="alert alert-info mt-3 rounded-0" id="selectionWarning" style="display: block;">
                            Please select a quantity of 1 or more.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section id="cart-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6">Your Shopping Cart</h1>
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="#" onclick="showSection('shop-catalog')">Products</a></li>
                <li class="breadcrumb-item active text-white">Cart</li>
            </ol>
        </div>

        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="bg-light p-4 rounded-0 shadow-sm">
                            <h3 class="mb-4">Items in Cart (<span id="cart-item-count">0</span>)</h3>
                            <div id="cart-items-list" class="list-group">
                                <p class="text-muted text-center p-5" id="empty-cart-message">Your cart is empty.</p>
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary w-100 py-3 mt-4 rounded-0" onclick="showSection('shop-catalog')" id="continue-shopping-btn">
                             <i class="fas fa-arrow-left me-2"></i> Continue Shopping
                        </button>
                    </div>

                    <div class="col-lg-4">
                        <div class="bg-white p-4 rounded-0 shadow-lg sticky-top" style="top: 100px;">
                            <h3 class="mb-4 text-primary">Order Summary</h3>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Subtotal:</span>
                                <span class="fw-bold" id="cart-subtotal">PKR 0</span>
                            </div>
                            <div class="d-flex justify-content-between mb-4 border-bottom pb-3">
                                <span>Delivery:</span>
                                <span class="fw-bold text-success" id="cart-delivery-cost">PKR 0</span>
                            </div>
                            <div class="d-flex justify-content-between mb-4">
                                <h4 class="mb-0">Grand Total:</h4>
                                <h4 class="mb-0 text-primary" id="cart-grand-total">PKR 0</h4>
                            </div>
                            
                            <div class="product-option-group" data-option-key="CheckoutDeliveryType">
                                <label><i class="fas fa-truck me-2"></i> Delivery Method:</label>
                                <div class="d-flex flex-wrap gap-2">
                                    <label class="choice-card selected" id="checkout-delivery-home" onclick="Cart.setDeliveryType('HomeDelivery')">
                                        <input type="radio" name="option-CheckoutDeliveryType" value="HomeDelivery" checked>
                                        <span class="label-text">Home Delivery</span>
                                    </label>
                                    <label class="choice-card" id="checkout-delivery-pickup" onclick="Cart.setDeliveryType('SelfPickUp')">
                                        <input type="radio" name="option-CheckoutDeliveryType" value="SelfPickUp">
                                        <span class="label-text">Self Pick Up</span>
                                    </label>
                                </div>
                            </div>

                             <div class="product-option-group" id="checkout-shipping-zone-selector">
                                <label><i class="fas fa-map-marker-alt me-2"></i> Shipping Zone:</label>
                                <input type="text" id="checkout-input-city" placeholder="Enter City for Shipping" class="form-control rounded-0 mb-2" oninput="Cart.manualLocationCheck()">
                                <small class="text-muted d-block" id="checkout-current-location-display">
                                    Zone: <span id="checkout-zone-name" class="fw-bold text-dark">Jalalpur Jattan (Within City)</span>
                                </small>
                            </div>

                            <button class="btn btn-primary w-100 py-3 mt-2 rounded-0" onclick="showSection('checkout')">
                                <i class="fas fa-money-check-alt me-2"></i> Proceed to Checkout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="checkout-section" class="section">
            <div class="container-fluid page-header py-5">
                <h1 class="text-center text-white display-6">Final Checkout</h1>
                <ol class="breadcrumb justify-content-center mb-0">
                    <li class="breadcrumb-item"><a href="#" onclick="showSection('cart')">Cart</a></li>
                    <li class="breadcrumb-item active text-white">Checkout</li>
                </ol>
            </div>

            <div class="container-fluid py-5">
                <div class="container py-5">
                    <div class="row g-4 justify-content-center">
                        <div class="col-lg-10">
                            <div class="bg-light p-4 rounded-0 shadow-lg">
                                <h3 class="mb-4">Contact & Payment</h3>
                                <form id="checkout-form" onsubmit="Cart.handleCheckoutSubmission(event)">
                                    
                                    <div class="product-option-group">
                                        <h4>1. Customer Information</h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control border-0 rounded-0" id="checkout-name" placeholder="Your Name" required>
                                                    <label for="checkout-name">Your Full Name</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="tel" class="form-control border-0 rounded-0" id="checkout-phone" placeholder="WhatsApp Number" required>
                                                    <label for="checkout-phone">WhatsApp/Contact Number</label>
                                                </div>
                                            </div>
                                            <div class="col-12" id="checkout-address-group">
                                                <div class="form-floating">
                                                    <textarea class="form-control border-0 rounded-0" placeholder="Full Address" id="checkout-address" style="height: 80px" required></textarea>
                                                    <label for="checkout-address">Full Shipping/Collection Address</label>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="form-floating">
                                                    <input type="email" class="form-control border-0 rounded-0" id="checkout-email" placeholder="Email (Optional)">
                                                    <label for="checkout-email">Email (Optional)</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="product-option-group mt-4">
                                        <h4>2. Payment Method</h4>
                                        <div class="d-flex flex-wrap gap-3">
                                            <label class="choice-card selected" id="payment-cod" onclick="Cart.setPaymentMethod('CashOnDelivery')">
                                                <input type="radio" name="option-PaymentMethod" value="CashOnDelivery" checked>
                                                <span class="label-text"><i class="fas fa-hand-holding-usd me-2"></i> Cash on Delivery (COD)</span>
                                            </label>
                                            <label class="choice-card" id="payment-bank" onclick="Cart.setPaymentMethod('BankTransfer')">
                                                <input type="radio" name="option-PaymentMethod" value="BankTransfer">
                                                <span class="label-text"><i class="fas fa-university me-2"></i> Bank Transfer (Pre-Payment)</span>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="alert alert-info mt-4 rounded-0">
                                        <strong>Order Total:</strong> <span class="fw-bold text-primary" id="checkout-grand-total">PKR 0</span>.
                                        By clicking "Confirm Order", we will open WhatsApp for final confirmation and processing.
                                    </div>

                                    <button class="btn btn-success w-100 py-3 mt-2 rounded-0" type="submit">
                                        <i class="fas fa-check-circle me-2"></i> Confirm Order via WhatsApp
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="quote-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6">Get a Custom Quote</h1>
        </div>
        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-4 justify-content-center">
                    <div class="col-lg-8">
                        <div class="bg-light p-4 rounded-0">
                            <form id="quote-form" onsubmit="handleQuoteSubmission(event)">
                                <h3 class="mb-4">Quick Inquiry for Wedding Cards</h3>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control border-0 rounded-0" id="quote-name" placeholder="Your Name" required>
                                            <label for="quote-name">Your Name</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="tel" class="form-control border-0 rounded-0" id="quote-phone" placeholder="WhatsApp Phone" required>
                                            <label for="quote-phone">WhatsApp Phone</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <input type="text" class="form-control border-0 rounded-0" id="quote-product" value="Wedding Invitation Cards" readonly>
                                            <label for="quote-product">Product Name / Design ID</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <input type="number" class="form-control border-0 rounded-0" id="quote-quantity" placeholder="Quantity (e.g., 500 cards)">
                                            <label for="quote-quantity">Required Quantity</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <textarea class="form-control border-0 rounded-0" placeholder="Details of your inquiry" id="quote-details" style="height: 150px" required></textarea>
                                            <label for="quote-details">Message</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <button class="btn btn-primary w-100 py-3 rounded-0" type="submit">Submit Quote via WhatsApp</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    
    <section id="contact-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6">Contact Us</h1>
        </div>
        <div class="container py-5 text-center">
             <h3>Contact us at +92 300 6238233</h3>
        </div>
    </section>

    <div class="container-fluid footer py-2">
        <div class="container text-center">
             <p class="text-white">Arham Printers 2025</p>
        </div>
    </div>

    <a href="#" class="btn btn-primary btn-lg-square back-to-top"><i class="fa fa-arrow-up"></i></a>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/cart-manager.js"></script>
<script>
    // ðŸ›‘ STEP 1: MANDATORY CONFIGURATION ðŸ›‘
    const PUBLIC_DATA_URL = 'all_prices.json'; 
    const WHATSAPP_NUMBER = '923006238233'; 
    const API_URL = 'submit_order.php';

    // ðŸ›‘ REPLACE THIS WITH YOUR ACTUAL GOOGLE MAPS API KEY ðŸ›‘
    const GOOGLE_MAPS_API_KEY = 'AIzaSyCAz3R9s0BdNnwgEtaC31LJcIqlkoXh05U'; 

    // --- Core Data Stores ---
    let allProducts = {}; 
    let currentCard = null;
    let hasInner = false; 
    
    // --- WEDDING CARD COST CONSTANTS ---
    const BULK_QTY = 100; 
    const INNER_COST_PER_CARD = 10; 
    const FIXED_OVERHEAD = 500;
    
    // --- PROFIT & COST CONSTANTS (Derived from previous analysis) ---
    const RECOMMENDED_MARKUP = 1.15; // Base 15% Profit Margin
    const LOCAL_FREE_SHIPPING_THRESHOLD = 2500; // PKR 2,500
    
    // Tiered Profit Multiplier for Wedding Cards based on Quantity
    const PROFIT_TIERS = [
        { min: 1, max: 50, multiplier: 1.15 },    
        { min: 51, max: 100, multiplier: 1.12 },   
        { min: 101, max: 300, multiplier: 1.10 },  
        { min: 301, max: 500, multiplier: 1.09 },  
        { min: 501, max: Infinity, multiplier: 1.09 }, 
    ];

    function getPrintingChargePerCard(quantity) {
        if (quantity >= 1 && quantity <= 50) return 18;
        if (quantity >= 51 && quantity <= 100) return 10;
        if (quantity >= 101 && quantity <= 300) return 8;
        if (quantity >= 301 && quantity <= 500) return 6;
        return 6; 
    }

    // --- SHIPPING RATE CONFIGURATION ---
    const SHIPPING_RATES = {
        'small': { 'Within City': 100, 'Same Province': 347, 'Cross Province': 359 },
        'medium': { 'Within City': 100, 'Same Province': 529, 'Cross Province': 541 },
    };

    const LOCAL_SHIPPING_RATES = { // Self-Delivery Rates
        'small': 150, 
        'medium': 200, 
    };

    const CITY_TO_ZONE = {
        "jalalpur jattan": "Within City", "gujrat": "Same Province", "gujranwala": "Same Province", 
        "lahore": "Same Province", "sialkot": "Same Province", "karachi": "Cross Province",
    };
    let currentShippingZone = 'Within City'; 
    let currentDeliveryType = 'HomeDelivery'; 

    
    function getShippingPacketType(productName) {
        // Wedding cards are typically heavy, classifying as small/medium depends on quantity
        // Assume 'small' for simplicity in single-item calculation here
        return 'small'; 
    }

    function getPostExShippingCost(packetType, zone) {
        const rates = SHIPPING_RATES[packetType];
        if (rates && rates[zone]) return rates[zone];
        return rates['Cross Province']; 
    }
    
    // ðŸ›‘ NEW: Function to set and update the delivery type ðŸ›‘
    function setDeliveryType(type, triggerPriceUpdate = true) {
        currentDeliveryType = type;
        const shippingZoneSelector = document.getElementById('shipping-zone-selector');
        
        // Update the visual state of the choice cards
        const homeLabel = document.getElementById('delivery-home');
        const pickupLabel = document.getElementById('delivery-pickup');
        
        if (homeLabel) homeLabel.classList.toggle('selected', type === 'HomeDelivery');
        if (pickupLabel) pickupLabel.classList.toggle('selected', type === 'SelfPickUp');
        
        // Show/hide the shipping zone selector based on delivery type
        if (type === 'SelfPickUp') {
            shippingZoneSelector.style.display = 'none';
        } else {
            shippingZoneSelector.style.display = 'block';
        }
        
        if (triggerPriceUpdate) updateQuantityAndPrice(0);
    }
    
    // --- LOCATION DETECTION LOGIC (Identical to products.html) ---

    function manualLocationCheck() {
        const cityInput = document.getElementById('input-city').value.trim();
        if (cityInput.length < 3) return;
        updateShippingZone(cityInput);
    }

    function detectLocation() {
        if (GOOGLE_MAPS_API_KEY === 'YOUR_API_KEY_HERE') {
            Cart.showAlert("API Key not configured. Cannot auto-detect location.", 'error');
            return;
        }
        document.getElementById('zone-name').textContent = "Detecting...";
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else {
            Cart.showAlert("Geolocation is not supported by this browser.", 'error');
        }
    }

    function showPosition(position) {
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;
        const geocoder = new google.maps.Geocoder();
        const latlng = { lat: parseFloat(lat), lng: parseFloat(lng) };

        geocoder.geocode({ location: latlng }, (results, status) => {
            if (status === "OK" && results[0]) {
                const addressComponents = results[0].address_components;
                let detectedCity = "";

                addressComponents.forEach(component => {
                    if (component.types.includes("locality")) {
                        detectedCity = component.long_name;
                    }
                });
                
                if (detectedCity) {
                     document.getElementById('input-city').value = detectedCity;
                     updateShippingZone(detectedCity);
                } else {
                     document.getElementById('zone-name').textContent = "City not found. Defaulting to JLP.";
                }
            } else {
                Cart.showAlert(`Geolocation failed: ${status}`, 'error');
                document.getElementById('zone-name').textContent = "Detection Failed. Defaulting to JLP.";
            }
        });
    }

    function showError(error) {
        Cart.showAlert("Error detecting location: " + error.message, 'error');
        document.getElementById('zone-name').textContent = "Detection Failed. Defaulting to JLP.";
    }

    function updateShippingZone(cityName) {
        const normalizedCity = cityName.toLowerCase().replace(/[^a-z0-9]/g, ' ').trim();
        let zone = 'Cross Province'; 
        
        if (CITY_TO_ZONE[normalizedCity]) {
            zone = CITY_TO_ZONE[normalizedCity];
        } else {
            if (cityName.toLowerCase().includes('lahore') || cityName.toLowerCase().includes('gujrat')) {
                 zone = 'Same Province';
            }
        }
        
        currentShippingZone = zone;
        
        const zoneDisplay = document.getElementById('zone-name');
        zoneDisplay.textContent = `${currentShippingZone} (${cityName})`;
        zoneDisplay.classList.remove('text-success', 'text-warning', 'text-danger');
        zoneDisplay.classList.add(zone === 'Within City' ? 'text-success' : (zone === 'Same Province' ? 'text-warning' : 'text-danger'));
        
        updateQuantityAndPrice(0); 
    }
    
    // --- INITIALIZATION AND FETCHING ---

    async function initialAppLoad() {
        // Inject Google Maps API script
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&libraries=places`;
        document.head.appendChild(script);
        
        let rawData;
        try {
            const response = await fetch(PUBLIC_DATA_URL);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            rawData = await response.json(); 
        } catch (error) {
            console.error("Failed to load shop data:", error);
            Cart.showAlert("Failed to load wedding card data. Check console or network.", 'error');
            return;
        }
        
        initialCardSetup(rawData);
        loadWeddingCards();
        
        const spinner = document.getElementById('loading-spinner');
        if (spinner) spinner.style.display = 'none';
        
        showSection('shop-catalog'); 
        
        // Initial setup for delivery/location display
        setDeliveryType('HomeDelivery', false); // Initialize UI state and default zone
        document.getElementById('zone-name').textContent = `Jalalpur Jattan (Default)`;
        document.getElementById('zone-name').classList.add('text-success');

    }

    function initialCardSetup(flatData) {
        const tieredWeddingData = flatData['Special Occasions (Wedding)'];
        allProducts = {};
        const BENCHMARK_QTY = 100;

        if (!tieredWeddingData || Object.keys(tieredWeddingData).length === 0) {
            document.getElementById('wedding-card-grid').innerHTML = '<p class="alert alert-danger">Error: Wedding card data structure missing from JSON response or empty.</p>';
            return;
        }

        Object.keys(tieredWeddingData).forEach(tierName => {
            const cardsInTier = tieredWeddingData[tierName].cards || {};
            Object.keys(cardsInTier).forEach(cardName => {
                const card = cardsInTier[cardName];
                const rawMaterialCost100 = card.bulkPrice100 || 0; 

                const printingChargePerCard = getPrintingChargePerCard(BENCHMARK_QTY);
                const totalPrintingCharges = printingChargePerCard * BENCHMARK_QTY;
                
                const TOTAL_COST_100_PCS = rawMaterialCost100 + FIXED_OVERHEAD + totalPrintingCharges;
                
                const VARIABLE_UNIT_COST = (rawMaterialCost100 + totalPrintingCharges) / BENCHMARK_QTY;

                const requiresInner = card.hasInnerCardOption === true;

                allProducts[cardName] = {
                    ...card,
                    cardName: cardName,
                    category: tierName,
                    bulkPrice100: TOTAL_COST_100_PCS, 
                    estimatedUnitCost: VARIABLE_UNIT_COST, 
                    fixedCost: FIXED_OVERHEAD,
                    printingChargePerCard: printingChargePerCard,
                    requiresInnerOption: requiresInner
                };
            });
        });
    }


    // --- PRICING CALCULATION LOGIC (CRITICAL UPDATE) ---

    function calculateFinalPrice(quantity) {
        if (quantity < 1 || !currentCard) return { error: "No product selected or invalid quantity" };
        
        // 1. Calculate Base Product Price (Cost before Shipping/Margin)
        const rawMaterialUnitCost = currentCard.bulkPrice100 / BULK_QTY - currentCard.fixedCost / BULK_QTY - currentCard.printingChargePerCard; 
        const actualPrintingCharge = getPrintingChargePerCard(quantity);
        const unitVariableCost = rawMaterialUnitCost + actualPrintingCharge;

        let totalVariableCost = unitVariableCost * quantity;
        const innerCost = hasInner ? (INNER_COST_PER_CARD * quantity) : 0;
        totalVariableCost += innerCost;
        
        let multiplier = 1.09; 
        for (const tier of PROFIT_TIERS) {
            if (quantity >= tier.min && quantity <= tier.max) {
                multiplier = tier.multiplier;
                break;
            }
        }
        
        const baseProductPrice = Math.round((totalVariableCost * multiplier) + currentCard.fixedCost);

        // 2. Calculate Shipping Cost
        const packetType = getShippingPacketType(currentCard.cardName);
        let shippingCost = 0;
        let finalShippingNote = '';

        if (currentDeliveryType === 'SelfPickUp') {
            shippingCost = 0;
            finalShippingNote = 'Self Pick Up. No shipping charges applied.';
        } else {
            // Home Delivery Logic
            if (currentShippingZone === 'Within City') {
                shippingCost = SHIPPING_RATES[packetType]['Within City'];
                finalShippingNote = `Local Delivery (Jalalpur Jattan). Flat rate for ${packetType.toUpperCase()} packet.`;
            } else {
                // Cross-Province/Same-Province
                shippingCost = getPostExShippingCost(packetType, currentShippingZone);
                finalShippingNote = `PostEx Courier (to ${currentShippingZone}). Price includes ${packetType.toUpperCase()} packet charge, fuel surcharge, and GST.`;
            }
        }

        const finalPrice = baseProductPrice + shippingCost;
        
        return { 
            baseProductPrice: baseProductPrice, 
            finalPrice: finalPrice, 
            shippingCost: shippingCost, 
            shippingNote: finalShippingNote, 
            options: { // Item-specific options for the cart
                'Quantity': quantity,
                'Inner Card': hasInner ? 'Yes' : 'No',
                'Design ID': currentCard.cardName
            }
        };
    }

    // --- DISPLAY and UI LOGIC (MODIFIED) ---

    function updateQuantityAndPrice(change = 0) {
        const input = document.getElementById('input-card-qty');
        let quantity = parseInt(input.value) || 1; 
        const MIN_QTY = 1;
        
        if (change !== 0) {
            quantity = Math.max(MIN_QTY, quantity + change);
        } else {
             quantity = Math.max(MIN_QTY, quantity);
        }
        
        input.value = quantity;
        
        if (currentCard && quantity >= MIN_QTY) {
            const result = calculateFinalPrice(quantity);
            
            if (result.error) {
                 // Fallback on error
                 document.getElementById('selectionWarning').textContent = result.error;
                 document.getElementById('selectionWarning').style.display = 'block';
                 return;
            }

            // --- Final Price Box Update ---
            document.getElementById('finalPriceDisplay').textContent = `PKR ${result.finalPrice.toLocaleString('en-PK', { minimumFractionDigits: 0 })}`;
            document.getElementById('finalPriceBox').style.display = 'block';
            document.getElementById('selectionWarning').style.display = 'none';

            // --- Shipping Display Box Update ---
            document.getElementById('shipping-cost-display').textContent = result.shippingCost === 0 ? "FREE" : `PKR ${result.shippingCost.toLocaleString('en-PK', { minimumFractionDigits: 0 })}`;
            document.getElementById('shipping-note-display').textContent = result.shippingNote;
            document.getElementById('shipping-display-box').style.display = 'block';

            // ðŸ›‘ REMOVED COST BREAKDOWN DISPLAY LINES:
            /*
            const bulkPriceDisplay = currentCard.bulkPrice100.toFixed(0);
            document.getElementById('fixed-cost-display').textContent = `**Total Cost (100 pcs: PKR ${bulkPriceDisplay}) used for calculation. Fixed overhead of ${currentCard.fixedCost} PKR applied after profit.**`;
            */
        } else {
             document.getElementById('finalPriceBox').style.display = 'none';
             document.getElementById('shipping-display-box').style.display = 'none';
             document.getElementById('selectionWarning').style.display = 'block';
        }
    }

    // ðŸ›‘ NEW: Function to Add Item to Cart ðŸ›‘
    function addItemToCart() {
        if (typeof Cart === 'undefined') {
            Cart.showAlert('Cart system not loaded.', 'error');
            return;
        }

        const quantity = parseInt(document.getElementById('input-card-qty').value) || 0;
        if (quantity < 1 || !currentCard) {
            Cart.showAlert('Please select a valid quantity (1 or more) before adding to cart.', 'error');
            return;
        }
        
        const result = calculateFinalPrice(quantity);
        
        if (result.error) {
            Cart.showAlert('Error adding item: ' + result.error, 'error');
            return;
        }

        const cartItem = {
            id: Date.now(), // Unique ID for this cart item
            productName: currentCard.cardName,
            quantity: quantity,
            basePrice: result.baseProductPrice, 
            finalItemPrice: result.finalPrice, // Total item price including calculated shipping
            options: result.options,
            isAreaBased: false,
            imageFile: currentCard.galleryImages ? currentCard.galleryImages[0] : currentCard.imageFile || 'img/wedding/placeholder.webp',
        };

        Cart.addItem(cartItem);
    }
    
    function setInnerSelection(selected, updatePrice = true) {
        hasInner = selected;

        const yesLabel = document.getElementById('inner-yes');
        const noLabel = document.getElementById('inner-no');
        
        if (yesLabel) yesLabel.classList.toggle('selected', selected);
        if (noLabel) noLabel.classList.toggle('selected', !selected);
        
        if (updatePrice) {
            updateQuantityAndPrice(0);
        }
    }

    function loadWeddingCards() {
        const categorizedCards = {};
        Object.values(allProducts).forEach(card => {
            const category = card.category; 
            if (!categorizedCards[category]) {
                categorizedCards[category] = [];
            }
            categorizedCards[category].push(card);
        });
        
        let cardHTML = '';
        let cardGrid = document.getElementById('wedding-card-grid');

        if (Object.keys(categorizedCards).length === 0) {
             cardGrid.innerHTML = '<p class="alert alert-warning">No card designs are currently available. Please contact us for a custom quote.</p>';
             return;
        }

        Object.keys(categorizedCards).forEach(category => {
            cardHTML += `<h3 class="w-100 pt-5 border-top">${category}</h3>`; 

            categorizedCards[category].forEach(card => {
                const cardName = card.cardName;
                const imagePath = card.galleryImages ? card.galleryImages[0] : card.imageFile || 'img/wedding/placeholder.webp'; 

                cardHTML += `
                    <div class='col-lg-3 col-6 mb-4'>
                        <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                            <span class='card-price rounded-0'>${cardName}</span> <img src='${imagePath}' onerror="this.onerror=null;this.src='img/wedding/placeholder.webp';" class='w-100' alt='${cardName}'>
                            <div class="product-footer-overlay p-0">
                                <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showCardDetails(&quot;${cardName}&quot;)">
                                    <i class="fas fa-search me-2"></i> View Details
                                </button>
                            </div>
                        </div>
                    </div>
                    `;
            });
        });

        cardGrid.innerHTML = cardHTML;
    }
    
    function showCardDetails(cardName) {
    const cardData = allProducts[cardName];
    if (!cardData) return;

    currentCard = cardData; 
    
    const innerOptionGroup = document.getElementById('inner-card-option-group');

    if (currentCard.requiresInnerOption === true) {
        innerOptionGroup.style.display = 'block';
        setInnerSelection(false, false); 
        document.getElementById('inner-yes').classList.remove('selected');
        document.getElementById('inner-no').classList.add('selected');
    } else {
        innerOptionGroup.style.display = 'none';
        hasInner = false; 
    }
    
    let images = [];
    if (Array.isArray(currentCard.galleryImages) && currentCard.galleryImages.length > 0) {
        images = currentCard.galleryImages;
    } else if (currentCard.imageFile) {
        images = [currentCard.imageFile];
    } else {
        images = ['img/wedding/placeholder.webp'];
    }

    const carouselInner = document.getElementById('carousel-inner');
    const carouselIndicators = document.getElementById('carousel-indicators');
    const imageGalleryContainer = document.getElementById('cardImageGallery');
    const carouselPrev = imageGalleryContainer.querySelector('.carousel-control-prev');
    const carouselNext = imageGalleryContainer.querySelector('.carousel-control-next');
    
    carouselInner.innerHTML = '';
    carouselIndicators.innerHTML = '';
    
    imageGalleryContainer.classList.remove('carousel', 'slide');
    if (images.length > 1) {
        imageGalleryContainer.classList.add('carousel', 'slide');
        carouselPrev.style.display = 'flex';
        carouselNext.style.display = 'flex';
        carouselIndicators.style.display = 'flex';
    } else {
        imageGalleryContainer.classList.remove('carousel', 'slide');
        carouselPrev.style.display = 'none';
        carouselNext.style.display = 'none';
        carouselIndicators.style.display = 'none';
        
        carouselInner.innerHTML = `
             <div class="carousel-item active">
                 <img src="${images[0]}" 
                      onerror="this.onerror=null;this.src='img/wedding/placeholder.webp';" 
                      class="d-block w-100 img-fluid rounded-0" 
                      alt="Card Image" style="max-height: 400px;">
             </div>`;
    }

    if (images.length > 1) {
        images.forEach((imagePath, index) => {
            const isActive = index === 0 ? 'active' : '';
            const itemHTML = `
                <div class="carousel-item ${isActive}">
                    <img src="${imagePath}" 
                         onerror="this.onerror=null;this.src='img/wedding/placeholder.webp';" 
                         class="d-block w-100 img-fluid rounded-0" 
                         alt="Card Image ${index + 1}" style="max-height: 400px;">
                </div>`;
            carouselInner.innerHTML += itemHTML;
            
            const indicatorHTML = `
                <button type="button" data-bs-target="#cardImageGallery" data-bs-slide-to="${index}" 
                        class="btn btn-sm btn-outline-light ${isActive}" aria-current="${isActive ? 'true' : 'false'}" 
                        aria-label="Slide ${index + 1}"></button>`;
            carouselIndicators.innerHTML += indicatorHTML;
        });
    }

    document.getElementById('detail-product-name-header').textContent = cardName;
    document.getElementById('detail-product-name-body').textContent = cardName;
    document.getElementById('card-description').textContent = currentCard.description; 
    document.getElementById('input-card-qty').value = 100; 
    
    // ðŸ›‘ REMOVED COST BREAKDOWN DISPLAY LOGIC ON SHOW DETAILS:
    /*
    const bulkPriceDisplay = currentCard.bulkPrice100.toFixed(0);
    document.getElementById('fixed-cost-display').textContent = `**Total Cost (100 pcs: PKR ${bulkPriceDisplay}) used for calculation. Fixed overhead of ${currentCard.fixedCost} PKR applied after profit.**`;
    */
    
    showSection('product-detail');
    updateQuantityAndPrice(0); 
}

    // --- ORDER SUBMISSION AND ALERT FUNCTIONS (MODIFIED) ---
    
    // Removed old submitOrder
    
    function handleQuoteSubmission(e) {
        e.preventDefault();
        const name = document.getElementById('quote-name').value;
        const phone = document.getElementById('quote-phone').value;
        const productID = document.getElementById('quote-product').value;
        const quantity = document.getElementById('quote-quantity').value;
        const details = document.getElementById('quote-details').value;
        
        let whatsappMessage = `*NEW WEDDING CARD QUOTE REQUEST (WEB)*\n`;
        whatsappMessage += `*Customer:* ${name}\n`;
        whatsappMessage += `*Phone:* ${phone}\n`;
        whatsappMessage += `*Product/ID:* ${productID}\n`;
        whatsappMessage += `*Required Quantity:* ${quantity}\n`;
        whatsappMessage += `*Details:* ${details}`;
        
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(whatsappMessage)}`, '_blank');
        Cart.showAlert('Quote submitted via WhatsApp! We will contact you shortly.', 'success');
        document.getElementById('quote-form').reset();
    }

    function showSection(sectionName) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        
        const target = document.getElementById(sectionName + '-section');
        if(target) target.classList.add('active');
        else document.getElementById('shop-catalog-section').classList.add('active');

        if (sectionName === 'quote' && currentCard) {
            document.getElementById('quote-product').value = currentCard.cardName;
            document.getElementById('quote-quantity').value = 500;
            document.getElementById('quote-details').value = `I am interested in ${currentCard.cardName}. I require approximately 500 pieces.`;
        }
        
        // Reload cart display on showing cart section
        if (sectionName === 'cart' && typeof Cart !== 'undefined') {
            Cart.updateCartDisplay();
        }

        window.scrollTo(0, 0);
    }
    
    // Use Cart.showAlert instead of local version
    function showAlert(message, type) {
        if (typeof Cart !== 'undefined' && typeof Cart.showAlert === 'function') {
            Cart.showAlert(message, type);
        }
    }
    
    document.addEventListener('DOMContentLoaded', initialAppLoad);
</script>
</div>
</body>
</html>
