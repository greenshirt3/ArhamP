<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9NHW41JTY2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9NHW41JTY2');
</script>
    <meta charset="utf-8">
    <title>Arham Printers - Product Catalog</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Printing Services, Business Cards, Stationery, Marketing Materials, Full Catalog" name="keywords">
    <meta content="Explore the full range of professional printing services and product catalog from Arham Printers." name="description">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    
    <style>
        /* General Layout and Utility Styles */
        :root {
            --bs-primary: #f28b00; /* Assuming this is your primary color */
            --bs-secondary: #ff5722; /* Example secondary color */
            --bs-dark: #212529;
            --mobile-nav-height: 60px;
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .final-price-box {
            background: var(--bs-primary);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            text-align: center;
            display: none; 
        }
        .final-price-box h4 {
            color: white;
        }
        
        /* ---------------------------------------------------- */
        /* RESPONSIVE HEADER IMAGE IMPLEMENTATION (NEW LOGIC) */
        /* ---------------------------------------------------- */
        .page-header {
            /* Default: Use Mobile Image (Mobile First Approach) */
            background: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0)), url(img/banners/productmobile.webp) center center no-repeat;
            background-size: cover;
            min-height: 250px;
        }

        @media (min-width: 768px) {
            .page-header {
                /* Override: Use Desktop Image on larger screens */
                background: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0)), url(img/banners/productdesk.webp) center center no-repeat;
                background-size: cover;
                min-height: 350px;
            }
        }
        /* ---------------------------------------------------- */
        
        /* --- DESKTOP NAV FIX --- */
        /* Remove margin from h1 inside the desktop navbar brand for alignment */
        .navbar-brand h1 {
            margin-top: 0;
            margin-bottom: 0;
        }

        /* Clickable Card Variations (Standard Items) */
        .choice-card {
            cursor: pointer;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 10px 15px;
            text-align: center;
            transition: all 0.2s ease;
            flex-grow: 1;
            min-width: 120px;
            opacity: 1; /* Default to visible */
        }
        .choice-card:hover {
            border-color: var(--bs-secondary);
            background-color: #fff8f8;
        }
        .choice-card.selected {
            border-color: var(--bs-primary);
            background-color: var(--bs-primary);
            color: white;
            box-shadow: 0 0 10px rgba(242, 139, 0, 0.3);
        }
        /* Style for visually disabling non-selectable options */
        .choice-card.disabled {
            opacity: 0.5;
            pointer-events: none; /* Disable interaction */
            border-color: #eee;
            background-color: #f7f7f7;
        }
        .choice-card input[type="radio"] {
            display: none;
        }
        .choice-card .label-text {
            font-weight: 500;
            color: var(--bs-dark);
            display: block;
        }
        .choice-card.selected .label-text {
            color: white;
        }
        .product-option-group {
            margin-bottom: 1.5rem;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .product-option-group label {
            font-weight: 600;
            color: var(--bs-dark);
            margin-bottom: 0.75rem;
            display: block;
            font-size: 1.1rem;
        }

        /* --- MOBILE BOTTOM NAVIGATION STYLES --- */

        /* 1. Mobile Bottom Bar Container */
        #mobile-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--mobile-nav-height);
            background: white;
            border-top: 1px solid #ddd;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
            z-index: 1030;
            display: flex;
            align-items: center;
            justify-content: space-around;
        }
        
        /* **FIX 1: Ensure all 5 top-level elements take equal width** */
        #mobile-bottom-nav > a, 
        #mobile-bottom-nav > div {
            flex: 1 1 0%; /* Equal distribution: 20% width per slot */
        }

        /* 2. Mobile Link Styling */
        .mobile-nav-link {
            flex: 1; 
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            text-decoration: none;
            color: var(--bs-dark);
            font-size: 0.6rem; /* Smaller text for compact look */
            padding: 5px 0;
            transition: color 0.2s;
            position: relative;
            height: 100%;
            justify-content: center;
        }
        .mobile-nav-link:hover {
             color: var(--bs-primary);
        }
        .mobile-nav-link i {
            font-size: 1.1rem;
            margin-bottom: 2px;
            line-height: 1;
        }
        .mobile-nav-link.active {
            color: var(--bs-primary);
        }
        

/* Update the existing #mobile-nav-logo section */
/* 3. Center Logo Button */
#mobile-nav-logo {
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative; /* Make it relative for absolute children */
}
#mobile-nav-logo a {
            background-color: var(--bs-primary);
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(242, 139, 0, 0.6);
            position: absolute; 
            top: -15px; 
            /* **FIX 2: Center absolutely positioned element within its slot** */
            left: 50%;
            transform: translateX(-50%); 
}

/* NEW RULE: Style the image inside the centered mobile button */
#mobile-nav-logo a img {
    /* Ensures the image is centered and prevents vertical alignment issues */
    vertical-align: middle; 
    /* Ensures the image doesn't overflow the 45px circle container */
    max-width: 80%; 
    max-height: 80%;
    height: auto !important; /* Overrides inline height if needed, maintaining aspect ratio */
}

#mobile-nav-logo a i {
            font-size: 1.5rem;
}
        /* 4. Content Padding to clear the fixed bottom nav */
        #shop-catalog-section, #product-detail-section, #quote-section, #contact-section, #cart-section, #checkout-section {
            padding-bottom: calc(var(--mobile-nav-height) + 15px); /* Add space for the bottom navbar */
        }
        
        /* 5. Compact Category Link Styling (Removed, but keeping class definitions minimal) */
        .categories-item a {
            font-size: 0.75rem; 
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px 0;
            line-height: 1.2;
        }
        .categories-item a i {
            font-size: 1.2rem; 
            margin-bottom: 5px !important;
        }
        
        /* 6. Mobile Dropdown Specific Styling */
        #mobile-bottom-nav .dropdown-menu {
            position: absolute;
            bottom: var(--mobile-nav-height); /* Position above the nav bar */
            left: 50%;
            transform: translateX(-50%);
            width: 250px;
            box-shadow: 0 -5px 15px rgba(0,0,0,0.2);
            border-radius: 8px 8px 0 0;
            padding: 10px 0;
        }
        #mobile-bottom-nav .dropdown-item {
             font-size: 0.8rem;
        }
    </style>
</head>

<body>
    <div class="container">
    <div class="container-fluid bg-dark text-white-50 py-2 px-0 d-none d-lg-block">
        <div class="row gx-0 align-items-center">
            <div class="col-lg-7 px-5 text-start">
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="fa fa-phone-alt me-2"></small>
                    <small>+92 300 6238233</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="far fa-envelope-open me-2"></small>
                    <small>info@arhamprinters.pk</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center me-4">
                    <small class="far fa-clock me-2"></small>
                    <small>Sat - Thu : 09 AM - 09 PM</small>
                </div>
            </div>
            <div class="col-lg-5 px-5 text-end">
                <div class="h-100 d-inline-flex align-items-center">
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-facebook-f"></i></a>
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-twitter"></i></a>
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-linkedin-in"></i></a>
                    <a class="text-white-50 ms-4" href=""><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </div>
    
    <nav class="navbar navbar-expand-lg bg-white navbar-light sticky-top px-4 px-lg-5 d-none d-lg-block">
    
    <div class="d-flex w-100 justify-content-between align-items-center">
        
        <a href="index.html" class="navbar-brand d-flex align-items-center me-4">
            <img src="img/logo2.webp" alt="Arham Printers Logo" style="height: 40px; margin-right: 1rem;">
                  </a>

        <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
    
        <div class="collapse navbar-collapse flex-grow-1" id="navbarCollapse">
            <div class="navbar-nav me-auto bg-light pe-4 py-3 py-lg-0 d-flex align-items-center">
                
                <a href="index.html" class="nav-item nav-link">Home</a>
                <a href="#" class="nav-item nav-link active" onclick="showSection('shop-catalog')">Products</a>
                <a href="wedding.html" class="nav-item nav-link">Wedding Cards</a>
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">Shop</a>
                    <div class="dropdown-menu bg-light border-0 m-0">
                        <a href="#" class="dropdown-item" onclick="showSection('shop-catalog')">All Products</a>
                        <a href="#quote-section" class="dropdown-item" onclick="showSection('quote')">Get Custom Quote</a>
                    </div>
                </div>
                <a href="#contact-section" class="nav-item nav-link" onclick="showSection('contact')">Contact</a>
            </div>
            
            <div class="h-100 d-lg-inline-flex align-items-center">
                <a class="btn-sm-square bg-white text-dark rounded-circle me-4 position-relative" href="#cart-section" onclick="showSection('cart')">
                    <i class="fas fa-shopping-cart"></i>
                    <span id="desktop-cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-primary" style="font-size: 0.6em; padding: 4px;">0</span>
                </a>
                <a href="#contact-section" class="btn btn-primary py-2 px-3 rounded-0 d-none d-lg-block" onclick="showSection('quote')">Get a Quote<i
                        class="fa fa-arrow-right ms-3"></i></a>
            </div>
        </div>
    </div>
</nav>

    <nav id="mobile-bottom-nav" class="d-lg-none">
    <a href="index.html" class="mobile-nav-link" id="mobile-link-home">
        <i class="fas fa-home"></i>
        <span>Home</span>
    </a>
    <a href="products.html" class="mobile-nav-link active" id="mobile-link-products">
        <i class="fas fa-th-list"></i>
        <span>Products</span>
    </a>
        <a href="wedding.html" class="mobile-nav-link" id="mobile-link-wedding">
            <i class="fas fa-gift"></i>
            <span>Wedding Cards</span>
        </a> 
        <a href="print-order.html" class="mobile-nav-link" id="mobile-link-wedding">
            <i class="fas fa-print"></i>
            <span>Custom Prints</span>
        </a> 
   <a href="#cart-section" class="mobile-nav-link" onclick="showSection('cart')" id="mobile-link-cart">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count" class="position-absolute translate-middle badge rounded-pill bg-primary" style="top: 8px; right: 10px; font-size: 0.7em;">0</span>
        <span>Cart</span>
    </a>
</nav>    
    <section id="shop-catalog-section" class="section active">
        <div class="container-fluid page-header py-5">
            <h2 class="text-center display-6">Products and Services</h2>
        </div>    
  <div class="container py-5">
            
            <div class="row g-4" id="main-product-catalog">
                
                <h3 class="w-100 pt-3" id="business-essentials">Business & Office Essentials</h3>
                
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/vcard.webp' onerror="this.onerror=null;this.src='img/products/vcard.png';" class='w-100' alt='Visiting Cards'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Visiting Cards')">
                                <i class="fas fa-search me-2"></i> Visiting Cards
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/matcards.webp' onerror="this.onerror=null;this.src='img/products/matcards.png';" class='w-100' alt='Mat Cards'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Mat Cards')">
                                <i class="fas fa-search me-2"></i> Mat Cards
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/uvcard.webp' onerror="this.onerror=null;this.src='img/products/uvcard.png';" class='w-100' alt='UV Cards'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('UV Cards')">
                                <i class="fas fa-search me-2"></i> UV Cards
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/thickcard.webp' onerror="this.onerror=null;this.src='img/products/thickcard.png';" class='w-100' alt='UV Thick Cards'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('UV Thick Cards')">
                                <i class="fas fa-search me-2"></i> UV Thick Cards
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/letterpad.webp' onerror="this.onerror=null;this.src='img/products/letterpad.png';" class='w-100' alt='Letterpad'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('letterpad')">
                                <i class="fas fa-search me-2"></i> letterpads
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/envelops.webp' onerror="this.onerror=null;this.src='img/products/envelops.png';" class='w-100' alt='envelops'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Envelops')">
                                <i class="fas fa-search me-2"></i> Envelops
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/billbooks.webp' onerror="this.onerror=null;this.src='img/products/billbooks.png';" class='w-100' alt='Bill Books'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Bill Books')">
                                <i class="fas fa-search me-2"></i> Bill Books
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/stamps.webp' onerror="this.onerror=null;this.src='img/products/stamps.png';" class='w-100' alt='Rubber Stamps'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Rubber Stamp (Rectangular)')">
                                <i class="fas fa-search me-2"></i> Rubber Stamps
                            </button>
                        </div>
                    </div>
                </div>
                <hr class="w-100" />

                <h3 class="w-100 pt-3" id="marketing-essentials">Marketing & Promotional Items</h3>
                
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/pamphlet.webp' onerror="this.onerror=null;this.src='img/products/pamphlets.png';" class='w-100' alt='pamphlets'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Ishtihar')">
                                <i class="fas fa-search me-2"></i> Pamphlets
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/flyers.webp' onerror="this.onerror=null;this.src='img/products/flyers.png';" class='w-100' alt='Flyers/Ishtihars'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Flyers/Ishtihars')">
                                <i class="fas fa-search me-2"></i> Flyers/Ishtihars
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/stickers.webp' onerror="this.onerror=null;this.src='img/products/Stickers.png';" class='w-100' alt='Stickers'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Stickers')">
                                <i class="fas fa-search me-2"></i> Stickers
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/shirt.webp' onerror="this.onerror=null;this.src='img/products/shirt.png';" class='w-100' alt='White T-Shirt (Adult Size)'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('White T-Shirt (Adult Size)')">
                                <i class="fas fa-search me-2"></i> White T-Shirt (Adult Size)
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/mugs.webp' onerror="this.onerror=null;this.src='img/products/Mug.png';" class='w-100' alt='Mug'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Mug')">
                                <i class="fas fa-search me-2"></i> Mug
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/pen.webp' onerror="this.onerror=null;this.src='img/products/pen.png';" class='w-100' alt='Metal Pen'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Metal Pen')">
                                <i class="fas fa-search me-2"></i> Metal Pen
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/bottle.webp' onerror="this.onerror=null;this.src='img/products/bottle.png';" class='w-100' alt='Water Bottle'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Water Bottle')">
                                <i class="fas fa-search me-2"></i> Water Bottle
                            </button>
                        </div>
                    </div>
                </div>
                <hr class="w-100" />

                <h3 class="w-100 pt-3" id="banners">Custom & Large Format</h3>
                
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/china.webp' onerror="this.onerror=null;this.src='img/products/china.png';" class='w-100' alt='China'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('China')">
                                <i class="fas fa-search me-2"></i> China
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/star.webp' onerror="this.onerror=null;this.src='img/products/star.png';" class='w-100' alt='Star'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Star')">
                                <i class="fas fa-search me-2"></i> Star
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/backlit.webp' onerror="this.onerror=null;this.src='img/products/backlit.png';" class='w-100' alt='Backlit'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Backlit')">
                                <i class="fas fa-search me-2"></i> Backlit
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/vision.webp' onerror="this.onerror=null;this.src='img/products/placeholder.png';" class='w-100' alt='OneVision Banner'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('One Vision')">
                                <i class="fas fa-search me-2"></i> OneVision
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/venyl.webp' onerror="this.onerror=null;this.src='img/products/venyl.png';" class='w-100' alt='Venyl Sticker'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Venyl Sticker')">
                                <i class="fas fa-search me-2"></i> Venyl Sticker
                            </button>
                        </div>
                    </div>
                </div>

                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/photos.webp' onerror="this.onerror=null;this.src='img/products/photopapers.png';" class='w-100' alt='Photo Papers'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('Photo Printing')">
                                <i class="fas fa-search me-2"></i> Photo Papers
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/wallpapers.webp' onerror="this.onerror=null;this.src='img/products/placeholder.png';" class='w-100' alt='3D Wallpaper'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showProductDetails('3D Wallpaper')">
                                <i class="fas fa-search me-2"></i> 3D Wallpaper
                            </button>
                        </div>
                    </div>
                </div>

                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/shields.webp' onerror="this.onerror=null;this.src='img/products/shields.png';" class='w-100' alt='Shields'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showSection('quote')">
                                <i class="fas fa-file-invoice me-2"></i> Shields (Custom Quote)
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/flags.webp' onerror="this.onerror=null;this.src='img/products/placeholder.png';" class='w-100' alt='Flags & Fabric'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showSection('quote')">
                                <i class="fas fa-file-invoice me-2"></i> Flags & Fabric
                            </button>
                        </div>
                    </div>
                </div>
                <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/box.webp' onerror="this.onerror=null;this.src='img/products/placeholder.png';" class='w-100' alt='Box Packaging'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-primary w-100 rounded-0 p-3" onclick="showSection('quote')">
                                <i class="fas fa-file-invoice me-2"></i> Box Packaging
                            </button>
                        </div>
                    </div>
                </div>

                <hr class="w-100" />

                <h3 class="w-100 pt-3" id="prints-and-documents">B/W and Color Prints</h3>
                 <div class='col-lg-3 col-6 mb-4'>
                    <div class='card h-100 shadow-sm product-card-hover-container rounded-0'> 
                        <img src='img/products/printer.webp' onerror="this.onerror=null;this.src='img/products/printer.png';" class='w-100' alt='Custom Prints'>
                        <div class="product-footer-overlay p-0">
                            <button class="btn btn-secondary w-100 rounded-0 p-3" onclick="showProductDetails('Custom Prints')">
                                <i class="fas fa-calculator me-2"></i> Paper Prints
                            </button>
                        </div>
                    </div>
                </di>
    </section>
    <section id="product-detail-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6" id="detail-product-name-header">Product Details</h1>
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="#" onclick="showSection('shop-catalog')">Catalog</a></li>
                <li class="breadcrumb-item active text-white">Details</li>
            </ol>
        </div>

        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-5">
                    <div class="col-lg-6">
                        <div class="d-flex justify-content-center">
                            <picture>
                                <source id="detail-product-image-webp" srcset="img/products/placeholder.webp" type="image/webp">
                                <img id="detail-product-image" src="img/products/placeholder.png" class="img-fluid rounded" alt="Product Image" style="max-height: 400px;">
                            </picture>
                        </div>
                    </div>
                    
                    <div class="col-lg-6">
                        <h2 class="fw-bold mb-4" id="detail-product-name-body">Product Name</h2>
                        
                        <div id="custom-area-inputs" style="display: none;">
                            <div class="product-option-group" data-option-key="Dimensions">
                                <label>Wall/Piece Dimensions (Feet):</label>
                                <div class="d-flex gap-3">
                                    <input type="number" id="input-width" min="1" placeholder="Width" class="form-control" oninput="updateFinalPrice()">
                                    <span class="align-self-center">x</span>
                                    <input type="number" id="input-height" min="1" placeholder="Height" class="form-control" oninput="updateFinalPrice()">
                                </div>
                                <small class="text-muted mt-2 d-block" id="areaDisplay"></small>
                            </div>
                            
                            <div class="product-option-group" data-option-key="Quantity">
                                <label>Number of Pieces/Walls:</label>
                                <input type="number" id="input-custom-qty" min="1" value="1" class="form-control" oninput="updateFinalPrice()">
                            </div>
                            
                            <div class="alert alert-danger mt-3" id="areaConstraintWarning" style="display: none;"></div>
                        </div>

                        <div id="standard-options-fields">
                            </div>
                        
                        <div class="product-option-group mt-4" data-option-key="DeliveryType">
                            <label><i class="fas fa-truck me-2"></i> <strong>Choose Delivery Method:</strong></label>
                            <div class="d-flex flex-wrap gap-3">
                                <label class="choice-card selected" id="delivery-home" onclick="setDeliveryType('HomeDelivery')">
                                    <input type="radio" name="option-DeliveryType" value="HomeDelivery" checked>
                                    <span class="label-text">Home Delivery</span>
                                </label>
                                <label class="choice-card" id="delivery-pickup" onclick="setDeliveryType('SelfPickUp')">
                                    <input type="radio" name="option-DeliveryType" value="SelfPickUp">
                                    <span class="label-text">Self Pick Up (No Shipping)</span>
                                </label>
                            </div>
                        </div>
                        <div class="product-option-group" id="shipping-zone-selector">
                            <label><i class="fas fa-map-marker-alt me-2"></i> <strong>Check Delivery Charges:</strong></label>
                            
                            <div class="d-flex gap-2 mb-2">
                                <button class="btn btn-outline-primary w-50 rounded-0" onclick="detectLocation()">
                                    <i class="fas fa-search-location me-2"></i> Auto-Detect My City
                                </button>
                                <input type="text" id="input-city" placeholder="Or Enter Your City Name" class="form-control rounded-0 w-50" oninput="manualLocationCheck()">
                            </div>
                            
                            <small class="text-muted d-block mb-2" id="current-location-display">
                                Current Zone: <span id="zone-name" class="fw-bold text-dark">Jalalpur Jattan (Default)</span>
                            </small>
                        </div>
                        <div class="final-price-box" id="finalPriceBox">
                            <h4 class="mb-2">Total Price (PKR)</h4>
                            <h3 class="display-6 fw-bold" id="finalPriceDisplay">PKR 0</h3>
                            
                            <div class="alert alert-light mt-3 p-3 rounded-0" id="shipping-display-box" style="display: none;">
                                <h5 class="mb-1 text-success">Shipping: <span id="shipping-cost-display" class="fw-bold text-dark">PKR 0</span></h5>
                                <small id="shipping-note-display" class="d-block text-dark"></small>
                            </div>
                            <button class="btn btn-success py-2 px-4 w-100 mt-3" onclick="addItemToCart()">
                                <i class="fas fa-cart-plus me-2"></i> Add to Cart
                            </button>
                        </div>
                        
                        <div class="alert alert-info mt-3" id="selectionWarning" style="display: block;">
                            Please enter dimensions/quantity or select all options above to see the final price.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="custom-print-tnc-upload" style="display:none;" class="container-fluid py-5">
        <div class="container py-5 pt-0">
            <div class="row g-4">
                <div class="col-lg-5">
                    <div class="bg-light p-4 rounded-0 shadow-sm border border-primary">
                        <h4 class="mb-3 text-primary"><i class="fas fa-upload me-2"></i> Document Upload (Step 2)</h4>
                        <p class="text-muted small">After selecting all options above, please upload your file(s). We recommend PDF format.</p>
                        
                        <div class="alert alert-info">
                            <i class="fas fa-exclamation-triangle me-2"></i> **Important:** We use **OneDrive** for secure file transfer. Files will be deleted after 7 days.
                        </div>
                        
                        <a href="https://onedrive.live.com/prev?id=A8E71F1A2C3D4B5F%21102" target="_blank" class="btn btn-dark w-100 py-3" id="file-upload-button">
                             <i class="fas fa-folder-open me-2"></i> Upload Your File(s) Now (Opens New Tab)
                        </a>
                        <p class="small text-danger mt-2">Do not close this page after uploading. You must continue to checkout.</p>
                    </div>
                </div>

                <div class="col-lg-7">
                    <div class="bg-white p-4 rounded-0 shadow-sm border">
                        <h4 class="mb-3"><i class="fas fa-file-contract me-2"></i> Print Service Terms & Conditions</h4>
                        <p class="small fw-bold border-bottom pb-2">By placing an order, you confirm you have read and agree to our Print Service Terms & Conditions.</p>
                        
                        <div style="max-height: 400px; overflow-y: auto; padding-right: 10px;">
                            <h6 class="text-primary mt-3">1. File Submission & Quality</h6>
                            <ul>
                                <li>**File Format:** We strongly recommend submitting files in **PDF format** for the highest compatibility and print quality. We also accept JPG, PNG, DOCX, and PPTX.</li>
                                <li>**Preparation:** All documents must be **unzipped and free of password protection**. The customer is responsible for ensuring the file is correctly sized (e.g., an A4 file for A4 prints).</li>
                                <li>**Borderless Printing:** We are unable to offer borderless (full bleed) printing via this standard online service. A small white margin will be applied to all prints.</li>
                            </ul>

                            <h6 class="text-primary">2. Content & Order Restriction</h6>
                            <ul>
                                <li>**Inappropriate Content:** We reserve the right to decline any order that, in our sole judgment, contains offensive, inflammatory, discriminatory, illegal, or otherwise inappropriate content.</li>
                            </ul>

                            <h6 class="text-primary">3. Payment & Refunds</h6>
                            <ul>
                                <li>**Non-Refundable:** All print orders are considered **non-refundable** once the printing process has commenced.</li>
                                <li>**Quality Guarantee:** If you encounter any issues with the print quality due to our error, we are happy to provide a **free reprint** if the issue is reported within **24 hours** of collection or delivery.</li>
                                <li>**Delivery Charges:** The final price confirmed via WhatsApp will include delivery charges, which will be determined based on the customer's delivery address.</li>
                            </ul>
                            
                            <h6 class="text-primary">4. Data Security (GDPR Compliance)</h6>
                            <ul>
                                <li>**Digital File Retention:** To protect your privacy, all digital files uploaded to our OneDrive folder will be automatically deleted from our server/cloud storage after **7 days** from order completion.</li>
                                <li>**Uncollected Prints:** Physical documents that are uncollected will be securely shredded in accordance with GDPR after **30 days** of the order date. No refund will be issued for uncollected prints.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section id="cart-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6">Your Shopping Cart</h1>
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="#" onclick="showSection('shop-catalog')">Products</a></li>
                <li class="breadcrumb-item active text-white">Cart</li>
            </ol>
        </div>

        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="bg-light p-4 rounded-0 shadow-sm">
                            <h3 class="mb-4">Items in Cart (<span id="cart-item-count">0</span>)</h3>
                            <div id="cart-items-list" class="list-group">
                                <p class="text-muted text-center p-5" id="empty-cart-message">Your cart is empty.</p>
                            </div>
                        </div>
                        
                        <button class="btn btn-secondary w-100 py-3 mt-4 rounded-0" onclick="showSection('shop-catalog')" id="continue-shopping-btn">
                             <i class="fas fa-arrow-left me-2"></i> Continue Shopping
                        </button>
                    </div>

                    <div class="col-lg-4">
                        <div class="bg-white p-4 rounded-0 shadow-lg sticky-top" style="top: 100px;">
                            <h3 class="mb-4 text-primary">Order Summary</h3>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Subtotal:</span>
                                <span class="fw-bold" id="cart-subtotal">PKR 0</span>
                            </div>
                            <div class="d-flex justify-content-between mb-4 border-bottom pb-3">
                                <span>Delivery:</span>
                                <span class="fw-bold text-success" id="cart-delivery-cost">PKR 0</span>
                            </div>
                            <div class="d-flex justify-content-between mb-4">
                                <h4 class="mb-0">Grand Total:</h4>
                                <h4 class="mb-0 text-primary" id="cart-grand-total">PKR 0</h4>
                            </div>
                            
                            <div class="product-option-group" data-option-key="CheckoutDeliveryType">
                                <label><i class="fas fa-truck me-2"></i> Delivery Method:</label>
                                <div class="d-flex flex-wrap gap-2">
                                    <label class="choice-card selected" id="checkout-delivery-home" onclick="Cart.setDeliveryType('HomeDelivery')">
                                        <input type="radio" name="option-CheckoutDeliveryType" value="HomeDelivery" checked>
                                        <span class="label-text">Home Delivery</span>
                                    </label>
                                    <label class="choice-card" id="checkout-delivery-pickup" onclick="Cart.setDeliveryType('SelfPickUp')">
                                        <input type="radio" name="option-CheckoutDeliveryType" value="SelfPickUp">
                                        <span class="label-text">Self Pick Up</span>
                                    </label>
                                </div>
                            </div>

                             <div class="product-option-group" id="checkout-shipping-zone-selector">
                                <label><i class="fas fa-map-marker-alt me-2"></i> Shipping Zone:</label>
                                <input type="text" id="checkout-input-city" placeholder="Enter City for Shipping" class="form-control rounded-0 mb-2" oninput="Cart.manualLocationCheck()">
                                <small class="text-muted d-block" id="checkout-current-location-display">
                                    Zone: <span id="checkout-zone-name" class="fw-bold text-dark">Jalalpur Jattan (Within City)</span>
                                </small>
                            </div>

                            <button class="btn btn-primary w-100 py-3 mt-2 rounded-0" onclick="showSection('checkout')">
                                <i class="fas fa-money-check-alt me-2"></i> Proceed to Checkout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="checkout-section" class="section">
            <div class="container-fluid page-header py-5">
                <h1 class="text-center text-white display-6">Final Checkout</h1>
                <ol class="breadcrumb justify-content-center mb-0">
                    <li class="breadcrumb-item"><a href="#" onclick="showSection('cart')">Cart</a></li>
                    <li class="breadcrumb-item active text-white">Checkout</li>
                </ol>
            </div>

            <div class="container-fluid py-5">
                <div class="container py-5">
                    <div class="row g-4 justify-content-center">
                        <div class="col-lg-10">
                            <div class="bg-light p-4 rounded-0 shadow-lg">
                                <h3 class="mb-4">Contact & Payment</h3>
                                <form id="checkout-form" onsubmit="Cart.handleCheckoutSubmission(event)">
                                    
                                    <div class="product-option-group">
                                        <h4>1. Customer Information</h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control border-0 rounded-0" id="checkout-name" placeholder="Your Name" required>
                                                    <label for="checkout-name">Your Full Name</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="tel" class="form-control border-0 rounded-0" id="checkout-phone" placeholder="WhatsApp Number" required>
                                                    <label for="checkout-phone">WhatsApp/Contact Number</label>
                                                </div>
                                            </div>
                                            <div class="col-12" id="checkout-address-group">
                                                <div class="form-floating">
                                                    <textarea class="form-control border-0 rounded-0" placeholder="Full Address" id="checkout-address" style="height: 80px" required></textarea>
                                                    <label for="checkout-address">Full Shipping/Collection Address</label>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="form-floating">
                                                    <input type="email" class="form-control border-0 rounded-0" id="checkout-email" placeholder="Email (Optional)">
                                                    <label for="checkout-email">Email (Optional)</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="product-option-group mt-4">
                                        <h4>2. Payment Method</h4>
                                        <div class="d-flex flex-wrap gap-3">
                                            <label class="choice-card selected" id="payment-cod" onclick="Cart.setPaymentMethod('CashOnDelivery')">
                                                <input type="radio" name="option-PaymentMethod" value="CashOnDelivery" checked>
                                                <span class="label-text"><i class="fas fa-hand-holding-usd me-2"></i> Cash on Delivery (COD)</span>
                                            </label>
                                            <label class="choice-card" id="payment-bank" onclick="Cart.setPaymentMethod('BankTransfer')">
                                                <input type="radio" name="option-PaymentMethod" value="BankTransfer">
                                                <span class="label-text"><i class="fas fa-university me-2"></i> Bank Transfer (Pre-Payment)</span>
                                            </label>
                                            <label class="choice-card" id="payment-raast" onclick="Cart.setPaymentMethod('RaastQR')">
                                                <input type="radio" name="option-PaymentMethod" value="RaastQR">
                                                <span class="label-text"><i class="fas fa-qrcode me-2"></i> Raast QR (Instant Pay)</span>
                                            </label>
                                        </div>
                                    </div>

                                    <div id="raast-qr-display" class="product-option-group mt-4 p-4 text-center bg-white border border-success" style="display: none;">
                                        <h4><i class="fas fa-qrcode me-2 text-success"></i> Instant Payment via Raast</h4>
                                        <p class="text-muted">Scan the QR code with any Raast-enabled banking app to pay the exact amount instantly. The Grand Total is automatically embedded.</p>
                                        
                                        <div class="d-flex justify-content-center">
                                            <img src="img/qr.webp" id="raast-qr-image" alt="Raast QR Code" style="width: 200px; height: 200px; border: 5px solid #28a745;">
                                        </div>
                                        
                                        <p class="fw-bold mt-3">Grand Total: <span id="raast-qr-amount" class="text-primary">PKR 0</span></p>
                                        <small class="text-success d-block">This payment method requires instant confirmation via WhatsApp after scanning.</small>
                                    </div>
                                    <div class="alert alert-info mt-4 rounded-0">
                                        <strong>Order Total:</strong> <span class="fw-bold text-primary" id="checkout-grand-total">PKR 0</span>.
                                        By clicking "Confirm Order", we will open WhatsApp for final confirmation and processing.
                                    </div>

                                    <button class="btn btn-success w-100 py-3 mt-2 rounded-0" type="submit">
                                        <i class="fas fa-check-circle me-2"></i> Confirm Order via WhatsApp
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="quote-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6">Get a Custom Quote</h1>
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active text-white">Quote</li>
            </ol>
        </div>

        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-4 justify-content-center">
                    <div class="col-lg-8">
                        <div class="bg-light p-4 rounded">
                            <form id="quote-form" onsubmit="handleQuoteSubmission(event)">
                                <h3 class="mb-4">Quick Inquiry</h3>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control border-0" id="quote-name" placeholder="Your Name" required>
                                            <label for="quote-name">Your Name</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="tel" class="form-control border-0" id="quote-phone" placeholder="Contact Number" required>
                                            <label for="quote-phone">Contact Number</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <input type="text" class="form-control border-0" id="quote-product" placeholder="Product Name (e.g., Visiting Cards, 3D Wallpaper)">
                                            <label for="quote-product">Product Name / Type</label>
                                        </div>
                                    </div>
                                     <div class="col-12">
                                        <div class="form-floating">
                                            <input type="number" class="form-control border-0" id="quote-quantity" placeholder="Quantity or Total Area (e.g., 500 cards, 100 sq ft)">
                                            <label for="quote-quantity">Quantity / Estimated Area</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <textarea class="form-control border-0" placeholder="Details of your inquiry (Size, Finish, Quality, Message)" id="quote-details" style="height: 150px" required></textarea>
                                            <label for="quote-details">Inquiry Message / Specifications</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <button class="btn btn-primary w-100 py-3" type="submit">Submit Quote via WhatsApp</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    <section id="contact-section" class="section">
        <div class="container-fluid page-header py-5">
            <h1 class="text-center text-white display-6">Contact Us</h1>
            <ol class="breadcrumb justify-content-center mb-0">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item active text-white">Contact</li>
            </ol>
        </div>

        <div class="container-fluid py-5">
            <div class="container py-5">
                <div class="row g-4">
                    <div class="col-lg-4">
                        <div class="bg-light p-4 rounded">
                            <div class="d-flex align-items-center mb-4">
                                <div class="d-flex align-items-center justify-content-center border border-primary rounded-circle mb-3"
                                    style="width: 60px; height: 60px;">
                                    <i class="fa fa-map-marker-alt text-primary fs-4"></i>
                                </div>
                                <div class="ms-4">
                                    <h5 class="mb-2">Our Location</h5>
                                    <p class="mb-0">Domela Chowk,Tanda Road, Jalalpur Jattan</p>
                                </div>
                            </div>
                            
                            <div class="d-flex align-items-center mb-4">
                                <div class="d-flex align-items-center justify-content-center border border-primary rounded-circle mb-3"
                                    style="width: 60px; height: 60px;">
                                    <i class="fa fa-phone-alt text-primary fs-4"></i>
                                </div>
                                <div class="ms-4">
                                    <h5 class="mb-2">Call Us</h5>
                                    <p class="mb-0">+92 300 6238233</p>
                                </div>
                            </div>
                            
                            <div class="d-flex align-items-center">
                                <div class="d-flex align-items-center justify-content-center border border-primary rounded-circle mb-3"
                                    style="width: 60px; height: 60px;">
                                    <i class="fa fa-envelope text-primary fs-4"></i>
                                </div>
                                <div class="ms-4">
                                    <h5 class="mb-2">Email Us</h5>
                                    <p class="mb-0">info@arhamprinters.pk</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-lg-8">
                        <div class="bg-light p-4 rounded">
                            <form id="contact-form-whatsapp" onsubmit="handleContactSubmission(event)">
                                <h3 class="mb-4">Send a Direct Message</h3>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control border-0" id="contact-name" placeholder="Your Name" required>
                                            <label for="contact-name">Your Name</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control border-0" id="contact-subject" placeholder="Subject" required>
                                            <label for="contact-subject">Subject</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <textarea class="form-control border-0" placeholder="Leave a message here" id="contact-message" style="height: 150px" required></textarea>
                                            <label for="contact-message">Message</label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <button class="btn btn-primary w-100 py-3" type="submit">Send Message via WhatsApp</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
           <div class="container-fluid footer py-2">
            <div class="container py-2">
                <div class="row g-3">
                    <div class="col-6 col-md-3">
                        <div class="rounded p-2 d-flex flex-column align-items-center">
                            <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center mb-2 mx-auto"
                                style="width: 56px; height: 56px;">
                                <i class="fas fa-map-marker-alt fa-2x text-primary" style="line-height: 1;"></i>
                            </div>
                            <h6 class="text-white mt-1 mb-1">Address</h6>
                            <p class="text-white fw-bold mb-1 small text-center">Domela Chowk, Tanda Road, Jalalpur Jattan
                            </p>
                        </div>
                    </div>

                    <div class="col-6 col-md-3">
                        <div class="rounded p-2 d-flex flex-column align-items-center">
                            <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center mb-2 mx-auto"
                                style="width: 56px; height: 56px;">
                                <i class="fas fa-envelope fa-2x text-primary" style="line-height: 1);"></i>
                            </div>
                            <h6 class="text-white mt-1 mb-1">Mail Us</h6>
                            <p class="text-white fw-bold mb-1 small text-center">info@arhamprinters.pk</p>
                        </div>
                    </div>

                    <div class="col-6 col-md-3">
                        <div class="rounded p-2 d-flex flex-column align-items-center">
                            <a href="https://wa.me/923006238233" target="_blank" class="text-decoration-none">
                                <div class="rounded-circle bg-success d-flex align-items-center justify-content-center mb-2 mx-auto"
                                    style="width: 56px; height: 56px;">
                                    <i class="fab fa-whatsapp fa-2x text-white" style="line-height: 1;"></i>
                                </div>
                            </a>
                            <h6 class="text-white mt-1 mb-1">Direct Contact</h6>
                            <a href="https://wa.me/923006238233" target="_blank"
                                class="text-white-50 text-decoration-none">
                                <p class="text-white fw-bold mb-1 small text-center">+92 300 6238233</p>
                            </a>
                        </div>
                    </div>

                    <div class="col-6 col-md-3">
                        <div class="rounded p-2 d-flex flex-column align-items-center">
                            <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center mb-2 mx-auto"
                                style="width: 56px; height: 56px;">
                                <i class="fab fa-facebook-f fa-2x text-primary" style="line-height: 1;"></i>
                            </div>
                            <h6 class="text-white mt-1 mb-1">Follow Us</h6>
                            <div class="d-flex justify-content-center gap-1">
                                <a class="btn btn-square btn-outline-light rounded-circle" href="#"><i
                                        class="fab fa-twitter"></i></a>
                                <a class="btn btn-square btn-outline-light rounded-circle" href="#"><i
                                        class="fab fa-facebook-f"></i></a>
                                <a class="btn btn-square btn-outline-light rounded-circle" href="#"><i
                                        class="fab fa-youtube"></i></a>
                                <a class="btn btn-square btn-outline-light rounded-circle" href="#"><i
                                        class="fab fa-linkedin-in"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container-fluid copyright py-2">
                <div class="container">
                    <div class="row">
                        <div class="col-12 text-center">
                            <span class="text-white small">
                                <i class="fas fa-copyright text-light me-1"></i>
                                Arham Printers, All rights reserved 2025.
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <a href="#" class="btn btn-primary btn-lg-square back-to-top"><i class="fa fa-arrow-up"></i></a>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/cart-manager.js"></script> <script>
    // 🛑 STEP 1: MANDATORY CONFIGURATION 🛑
    const PUBLIC_DATA_URL = 'all_prices.json'; 
    const WHATSAPP_NUMBER = '923006238233'; 
    const SUBMIT_ORDER_URL = 'submit_order.php'; 
    
    // 🛑 REPLACE THIS WITH YOUR ACTUAL GOOGLE MAPS API KEY 🛑
    const GOOGLE_MAPS_API_KEY = 'AIzaSyCAz3R9s0BdNnwgEtaC31LJcIqlkoXh05U'; 

    // --- Core Data Stores ---
    let allProducts = {}; 
    let currentProduct = null; 
    let allProductGroups = {};
    let currentSelectedVariations = {}; 
    let customprintspricing = {};
    
    let currentShippingZone = 'Within City'; // Default to cheapest zone (JLP)
    let currentDeliveryType = 'HomeDelivery'; // NEW: Default to Home Delivery
    const CUSTOM_PRINTS_PRODUCT_NAME = "Custom Prints"; // Name of the product group using tiered pricing


    // --- Shipping Rate Configuration (PostEx with 15% Fuel & 16% GST) ---
    const SHIPPING_RATES = {
        // Within City (JLP) / Same Province / Cross Province
        'small': { 
            'Within City': 100, // MODIFIED: Flat rate for JLP Home Delivery
            'Same Province': 347,
            'Cross Province': 359
        },
        'medium': { 
            'Within City': 100, // MODIFIED: Flat rate for JLP Home Delivery
            'Same Province': 529,
            'Cross Province': 541
        },
        'overland': { 
            'Within City': 150, // MODIFIED: Flat rate for JLP Home Delivery
            'Same Province': 1254,
            'Cross Province': 1254
        }
    };

    // --- Local Shipping Rates/Thresholds (Removed/Simplified as per request) ---
    const LOCAL_DELIVERY_COST = 100; // Flat local rate

    // --- Zone Mapping Data (JLP is the Origin City) ---
    const CITY_TO_ZONE = {
        "jalalpur jattan": "Within City",
        "gujrat": "Same Province",
        "gujranwala": "Same Province",
        "lahore": "Same Province",
        "sialkot": "Same Province",
        "rawalpindi": "Same Province",
        "multan": "Same Province",
        "faisalabad": "Same Province",
        "karachi": "Cross Province",
        "islamabad": "Cross Province",
        "peshawar": "Cross Province",
        "quetta": "Cross Province",
        "sukkur": "Cross Province"
    };

    // --- PROFIT & COST CONSTANTS (Derived from previous analysis) ---
   
    const AREA_BASED_META = {
        "China": { is_area_based: true, rate: 35, min_area: 2, category: 'Banners' }, 
        "Star": { is_area_based: true, rate: 65, min_area: 2, category: 'Banners' },
        "Backlit": { is_area_based: true, rate: 100, min_area: 2, category: 'Banners' }, 
        "One Vision": { is_area_based: true, rate: 90, min_area: 2, category: 'Banners' }, // Name adjusted for JSON key
        "Venyl Sticker": { is_area_based: true, rate: 90, min_area: 2, category: 'Banners' }, // Name adjusted for JSON key  
        "3D Wallpaper": { is_area_based: true, rate: 30, min_area: 20, category: '3D Wallpaper' },
        "Photo Frames": { is_area_based: true, rate: 40, min_area: 1, category: 'Photo Printing' } 
    };
    const AREA_BASED_PRODUCT_NAMES = Object.keys(AREA_BASED_META);

    const DESIGN_FEE_TIERS = [
        { min_sqft: 1, max_sqft: 10, base_fee: 300 },
        { min_sqft: 11, max_sqft: 24, base_fee: 400 },
        { min_sqft: 25, max_sqft: 50, base_fee: 500 },
        { min_sqft: 51, max_sqft: Infinity, base_fee: 700 },
    ];
    const DESIGN_FEE_QTY_INCREMENT = 50;
    const DESIGN_FEE_QTY_THRESHOLD = 5;

    const AREA_PROFIT_TIERS = [
        { min_qty: 1, max_qty: 10, multiplier: 1.20 },
        { min_qty: 11, max_qty: 20, multiplier: 1.18 },
        { min_qty: 21, max_qty: 30, multiplier: 1.16 },
        { min_qty: 31, max_qty: 50, multiplier: 1.14 },
        { min_qty: 51, max_qty: Infinity, multiplier: 1.10 },
    ];

    // Map the generic SQL column name to a user-friendly display name
    const variantDisplayNames = {
        'variant_1': 'Size', 
        'variant_2': 'Material/Stock', 
        // 🛑 MODIFIED: Used for Photo Prints sizing 🛑
        'variant_3': 'Photo Size', 
        'single_side': 'Print Color (Single Side)',
        'double_side': 'Print Color (Double Side)',
        'finish': 'Finish',
        'shape': 'Shape',
        'material': 'Material',
    };
    
    const DISPLAY_ORDER = [
        'Photo Size', 'Pricing Option', 'Size', 'Material', 'Type/Finish', 'Finish', 'Print Color (Single Side)', 
        'Print Color (Double Side)', 'Material/Stock', 'Shape', 'Accessories', 'Inking Mechanism'
    ];

    function sortAttributeKeys(keys) {
        return keys.sort((a, b) => {
            const indexA = DISPLAY_ORDER.indexOf(a);
            const indexB = DISPLAY_ORDER.indexOf(b);
            if (indexA !== -1 && indexB !== -1) return indexA - indexB;
            if (indexA !== -1) return -1;
            if (indexB !== -1) return 1;
            return a.localeCompare(b); 
        });
    }

    function calculateDesignFee(itemAreaSqft, quantity) {
        let baseFee = 0;
        for (const tier of DESIGN_FEE_TIERS) {
            if (itemAreaSqft >= tier.min_sqft && itemAreaSqft <= tier.max_sqft) {
                baseFee = tier.base_fee;
                break;
            }
        }
        let qtyFee = 0;
        if (quantity > 1) {
            const additionalPieces = quantity - 1; 
            const additionsCount = Math.floor((additionalPieces + DESIGN_FEE_QTY_THRESHOLD - 1) / DESIGN_FEE_QTY_THRESHOLD);
            qtyFee = additionsCount * DESIGN_FEE_QTY_INCREMENT;
        }
        return baseFee + qtyFee;
    }

    function getAreaProfitMultiplier(quantity) {
        let multiplier = 1.10;
        for (const tier of AREA_PROFIT_TIERS) {
            if (quantity >= tier.min_qty && quantity <= tier.max_qty) {
                multiplier = tier.multiplier;
                break;
            }
        }
        return multiplier;
    }
    
    // --- CORE FUNCTIONS ---

    async function initialAppLoad() {
        // Inject Google Maps API script
        const script = document.createElement('script');
        script.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_API_KEY}&libraries=places`;
        document.head.appendChild(script);

        let rawData;
        try {
            const response = await fetch(PUBLIC_DATA_URL);
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            rawData = await response.json(); 
        } catch (error) {
            console.error("Failed to load shop data:", error);
            Cart.showAlert("Failed to load product data:", 'error');
            return;
        }
        
        initialProductSetup(rawData);
        showSection('shop-catalog'); 
        
        document.getElementById('quote-form').addEventListener('submit', handleQuoteSubmission);
        document.getElementById('contact-form-whatsapp').addEventListener('submit', handleContactSubmission);
        
        // Initial setup for location display
        setDeliveryType('HomeDelivery', false); // Initialize UI state and default zone
        document.getElementById('zone-name').textContent = `Jalalpur Jattan (Default)`;
        document.getElementById('zone-name').classList.add('text-success');

        if (typeof setActiveMobileNav === 'function') setActiveMobileNav('products');
    }
    
    function initialProductSetup(flatData) {
        const productGroups = {};
        Object.keys(flatData).forEach(categoryKey => {
            const categoryData = flatData[categoryKey];
            if (categoryKey === "B/W and Color Prints") {
                customprintspricing[CUSTOM_PRINTS_PRODUCT_NAME] = categoryData;
                if (Object.keys(categoryData || {}).length > 0) {
                    productGroups[CUSTOM_PRINTS_PRODUCT_NAME] = {
                         baseName: CUSTOM_PRINTS_PRODUCT_NAME, minPrice: 6, imageFile: `digital`, 
                         isAreaBased: false, mainCategory: categoryKey, isDigitalTiered: true, combinations: [] 
                    };
                }
                return;
            }
            if (categoryKey === "Special Occasions (Wedding)") return;

            Object.keys(categoryData).forEach(productKey => {
                 const productCombinations = categoryData[productKey];
                 if (!productGroups[productKey]) {
                     let imageFileBase = productKey.replace(/\s|\/|\(|\)/g, '').replace('Visiting', 'vcard').toLowerCase();
                     if (productKey === 'Ishtihar') imageFileBase = 'pamphlet';
                     if (productKey === 'T-Shirt Cotton' || productKey === 'T-Shirt Multicolor') imageFileBase = 'cottonshirt';
                     if (productKey === 'File Covers') imageFileBase = 'file';
                     
                     const isAreaBased = AREA_BASED_PRODUCT_NAMES.includes(productKey);
                     
                     productGroups[productKey] = {
                         baseName: productKey, minPrice: Infinity, imageFile: imageFileBase, 
                         isAreaBased: isAreaBased, mainCategory: categoryKey, combinations: [] 
                     };
                 }
                 
                 if (!productGroups[productKey].isAreaBased && Array.isArray(productCombinations)) {
                     productCombinations.forEach(item => {
                         // Standard price or default single price for initialization
                         const basePrice = parseFloat(item.price) || (item.pricing && item.pricing.single ? parseFloat(item.pricing.single) : 0); 
                         
                         // Helper function to extract common attributes
                         const getCommonAttributes = (price, customKey, customValue) => {
                             let attributes = { 'Price': price, 'FullName': productKey };
                             
                             // Add custom variant
                             if (customKey && customValue) {
                                attributes[customKey] = customValue;
                             }

                             // Store the full pricing structure if available (for Photo Printing bundles)
                             if (item.pricing) {
                                attributes['PricingStructure'] = item.pricing;
                             }
                             
                             Object.keys(item).forEach(key => {
                                 if (key !== 'price' && key !== 'imageFile' && key !== 'pricing' && item[key]) {
                                     const displayKey = variantDisplayNames[key] || key.charAt(0).toUpperCase() + key.slice(1);
                                     if (key !== 'variant_3' && displayKey === attributes.FullName) return; 
                                     
                                     // Only include attributes not covered by customKey/Value
                                     if (displayKey !== customKey) {
                                        attributes[displayKey] = item[key];
                                     }
                                 }
                             });
                             return attributes;
                         };

                         // 🛑 Special handling for Photo Printing 🛑
                         if (productKey === "Photo Printing" && item.pricing) {
                             const pricing = item.pricing;
                             
                             // 1. Add 'Single' option
                             let singleAttr = getCommonAttributes(pricing.single, 'Pricing Option', 'Single');
                             singleAttr['Quantity Multiplier'] = 1;
                             productGroups[productKey].combinations.push(singleAttr);
                             
                             // 2. Add Bundle options
                             Object.keys(pricing.bundles).forEach(qty => {
                                const quantity = parseInt(qty);
                                const bundlePrice = pricing.bundles[qty];
                                let bundleAttr = getCommonAttributes(bundlePrice, 'Pricing Option', `Bundle of ${quantity}`);
                                bundleAttr['Quantity Multiplier'] = quantity;
                                productGroups[productKey].combinations.push(bundleAttr);
                             });

                         } else {
                             // Standard product logic (including A4 photo print)
                             let attributes = getCommonAttributes(basePrice);
                             productGroups[productKey].combinations.push(attributes);
                         }
                         
                         // Update minPrice after combinations are added/flattened
                         if (basePrice > 0 && basePrice < productGroups[productKey].minPrice) {
                             productGroups[productKey].minPrice = basePrice;
                         }
                     });
                 }
            });
        });
        allProductGroups = productGroups;
    }

    function getShippingPacketType(productName) {
        if (productName.includes('Card') || productName.includes('Print') || productName.includes('Sticker')) return 'small';
        if (productName.includes('Letterpad') || productName.includes('Bill Book') || productName.includes('T-Shirt') || productName.includes('Mug') || productName.includes('Pen')) return 'medium';
        if (AREA_BASED_PRODUCT_NAMES.includes(productName) || productName.includes('Frame') || productName.includes('Banner') || productName.includes('Wallpaper') || productName.includes('Vision') || productName.includes('Venyl')) return 'overland';
        return 'small'; 
    }

    function getPostExShippingCost(packetType, zone) {
        const rates = SHIPPING_RATES[packetType];
        if (rates && rates[zone]) return rates[zone];
        return rates['Cross Province']; 
    }
    
    // 🛑 NEW: Function to set and update the delivery type 🛑
    function setDeliveryType(type, triggerPriceUpdate = true) {
        currentDeliveryType = type;
        const shippingZoneSelector = document.getElementById('shipping-zone-selector');
        
        document.querySelectorAll('input[name="option-DeliveryType"]').forEach(input => {
            input.closest('.choice-card')?.classList.remove('selected');
        });
        
        const selectedInput = document.querySelector(`input[name="option-DeliveryType"][value="${type}"]`);
        if (selectedInput) {
            selectedInput.checked = true;
            selectedInput.closest('.choice-card')?.classList.add('selected');
        }

        if (type === 'SelfPickUp') {
            shippingZoneSelector.style.display = 'none';
        } else {
            shippingZoneSelector.style.display = 'block';
        }
        
        if (triggerPriceUpdate) updateFinalPrice();
    }


    // --- LOCATION DETECTION LOGIC (Now mainly for currentShippingZone update) ---

    function manualLocationCheck() {
        const cityInput = document.getElementById('input-city').value.trim();
        if (cityInput.length < 3) return;
        updateShippingZone(cityInput);
    }

    function detectLocation() {
        if (GOOGLE_MAPS_API_KEY === 'AIzaSyCAz3R9s0BdNnwgEtaC31LJcIqlkoXh05U') {
            Cart.showAlert("API Key not configured. Cannot auto-detect location.", 'error');
            return;
        }
        document.getElementById('zone-name').textContent = "Detecting...";
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition, showError);
        } else {
            Cart.showAlert("Geolocation is not supported by this browser.", 'error');
        }
    }

    function showPosition(position) {
        const lat = position.coords.latitude;
        const lng = position.coords.longitude;
        const geocoder = new google.maps.Geocoder();
        const latlng = { lat: parseFloat(lat), lng: parseFloat(lng) };

        geocoder.geocode({ location: latlng }, (results, status) => {
            if (status === "OK" && results[0]) {
                const addressComponents = results[0].address_components;
                let detectedCity = "";

                addressComponents.forEach(component => {
                    if (component.types.includes("locality")) {
                        detectedCity = component.long_name;
                    }
                });
                
                if (detectedCity) {
                     document.getElementById('input-city').value = detectedCity;
                     updateShippingZone(detectedCity);
                } else {
                     document.getElementById('zone-name').textContent = "City not found. Defaulting to JLP.";
                }
            } else {
                Cart.showAlert(`Geolocation failed: ${status}`, 'error');
                document.getElementById('zone-name').textContent = "Detection Failed. Defaulting to JLP.";
            }
        });
    }

    function showError(error) {
        Cart.showAlert("Error detecting location: " + error.message, 'error');
        document.getElementById('zone-name').textContent = "Detection Failed. Defaulting to JLP.";
    }

    function updateShippingZone(cityName) {
        const normalizedCity = cityName.toLowerCase().replace(/[^a-z0-9]/g, ' ').trim();
        let zone = 'Cross Province'; 
        
        if (CITY_TO_ZONE[normalizedCity]) {
            zone = CITY_TO_ZONE[normalizedCity];
        } else {
            // Fallback check for major Punjab cities not explicitly listed
            if (cityName.toLowerCase().includes('lahore') || cityName.toLowerCase().includes('gujrat')) {
                 zone = 'Same Province';
            }
        }
        
        currentShippingZone = zone;
        
        const zoneDisplay = document.getElementById('zone-name');
        zoneDisplay.textContent = `${currentShippingZone} (${cityName})`;
        zoneDisplay.classList.remove('text-success', 'text-warning', 'text-danger');
        zoneDisplay.classList.add(zone === 'Within City' ? 'text-success' : (zone === 'Same Province' ? 'text-warning' : 'text-danger'));
        
        updateFinalPrice(); 
    }

    // --- Price Calculation Logic (MODIFIED to support Photo Printing Tiers and Digital Prints) ---
    
    function calculateItemPrice() {
        if (!currentProduct) return { error: "No product selected" };
        
        const isAreaBased = currentProduct.isAreaBased;
        const isDigitalTiered = currentProduct.isDigitalTiered;
        let baseProductPrice = 0;
        let requiresManualQuote = false;
        let quantity = 0;
        let itemOptions = {};
        let imageFile = document.getElementById('detail-product-image').src;

        // 1. Calculate Base Product Price (Cost before Shipping/Margin)
        if (isAreaBased) {
            // ... (Area-based logic remains unchanged)
            const width = parseFloat(document.getElementById('input-width').value) || 0;
            const height = parseFloat(document.getElementById('input-height').value) || 0;
            quantity = parseInt(document.getElementById('input-custom-qty').value) || 0;
            const rateMeta = AREA_BASED_META[currentProduct.baseName];
            const baseRate = rateMeta ? rateMeta.rate : 0;
            const minArea = rateMeta ? rateMeta.min_area || 0 : 0;
            const designService = currentSelectedVariations['DesignService'] || 'PrintReady';

            itemOptions['Dimensions'] = `${width} x ${height} ft`;
            itemOptions['Quantity'] = quantity;
            itemOptions['Design Service'] = designService;


            document.getElementById('areaConstraintWarning').style.display = 'none';
            if (width <= 0 || height <= 0 || quantity <= 0 || baseRate === 0) {
                document.getElementById('areaDisplay').textContent = '';
                requiresManualQuote = true;
            } else {
                const itemArea = width * height;
                const totalArea = itemArea * quantity;
                document.getElementById('areaDisplay').textContent = `Area per piece: ${itemArea.toFixed(2)} sq ft | Total Area: ${totalArea.toFixed(2)} sq ft | Rate: PKR ${baseRate.toFixed(2)}/sq ft`;
                if (totalArea < minArea) {
                    requiresManualQuote = true;
                }
                const basePrintCost = totalArea * baseRate;
                let totalDesignFee = 0;
                if (designService === 'DesignNeeded') {
                    totalDesignFee = calculateDesignFee(itemArea, quantity);
                }
                const totalCostBeforeProfit = basePrintCost + totalDesignFee;
                const profitMultiplier = getAreaProfitMultiplier(quantity);
                baseProductPrice = Math.round(totalCostBeforeProfit * profitMultiplier);
            }
        } 
        else if (isDigitalTiered) {
             quantity = parseInt(document.getElementById('input-standard-qty')?.value) || 0;
             
             // Normalize selection keys
             const size = currentSelectedVariations.Size;
             const colorType = currentSelectedVariations.ColorType; // Use original value which is already JSON format
             const gsm = currentSelectedVariations.GSM;
             const sides = currentSelectedVariations.Sides; 
             
             itemOptions = currentSelectedVariations;
             itemOptions['Quantity'] = quantity;
             
             if (!size || !colorType || !gsm || !sides || quantity <= 0) requiresManualQuote = true;
             
             try {
                // IMPORTANT: JSON keys for ColorType are "black_white" or "color", not user-friendly versions
                const tiers = customprintspricing[currentProduct.baseName];
                const gsmData = tiers[size][colorType][gsm];
                let unitPrice = 0;
                let rangeKeyUsed = 'N/A';
                let foundPrice = false;
                
                // 1. Find the base unit price based on quantity tier
                Object.keys(gsmData).forEach(rangeKey => {
                    const [min, max] = rangeKey.split('-').map(n => parseInt(n));
                    if (quantity >= min && (isNaN(max) || quantity <= max)) { 
                        unitPrice = gsmData[rangeKey];
                        rangeKeyUsed = rangeKey;
                        foundPrice = true;
                    }
                });
                
                if (foundPrice) {
                    // 2. Apply double-sided multiplier
                    const multiplier = (sides === 'double' ? 2 : 1);
                    const finalUnitPrice = unitPrice * multiplier;
                    
                    baseProductPrice = finalUnitPrice * quantity;

                    // 3. Update item options for display
                    itemOptions['Tier'] = `Pages: ${rangeKeyUsed} (${unitPrice.toFixed(2)} PKR Base)`;
                    itemOptions['Price/Page'] = `${finalUnitPrice.toFixed(2)} PKR`;

                } else {
                    requiresManualQuote = true;
                }
             } catch(e) {
                 requiresManualQuote = true;
             }
        }
        else {
            quantity = parseInt(document.getElementById('input-standard-qty')?.value) || 1;
            const allCombinations = currentProduct?.combinations || [];
            
            let allSelected = true;
            // Filter keys to exclude the internal fields
            const requiredKeys = Object.keys(allCombinations[0] || {}).filter(key => 
                key !== 'Price' && key !== 'FullName' && key !== 'PricingStructure' && key !== 'Quantity Multiplier'
            );

            requiredKeys.forEach(key => { 
                if (!currentSelectedVariations[key]) allSelected = false; 
                itemOptions[key] = currentSelectedVariations[key];
            });
            
            // For Photo Printing, use the Quantity Multiplier stored on the combo if it's a bundle
            if (currentProduct.baseName === "Photo Printing" && currentSelectedVariations['Pricing Option'] !== 'Single') {
                 // Quantity is determined by the bundle size, as locked in handleCardSelection
                 itemOptions['Quantity Option'] = currentSelectedVariations['Pricing Option'];
            } else {
                 // For all other products or 'Single' Photo Option, use the user's manual quantity input
                 itemOptions['Quantity'] = quantity;
            }


            if (!allSelected) requiresManualQuote = true;
            
            if (!requiresManualQuote) {
                let finalProductCombination = allCombinations.find(combo => 
                    requiredKeys.every(key => combo[key] === currentSelectedVariations[key])
                );
                
                if (finalProductCombination) {
                    
                    if (currentProduct.baseName === "Photo Printing" && finalProductCombination['Pricing Option']) {
                        // For Photo Printing, the 'Price' field holds the cost for the option (either single or bundle)
                        const unitPrice = finalProductCombination['Pricing Option'] === 'Single' ? finalProductCombination.Price : (finalProductCombination.Price / finalProductCombination['Quantity Multiplier']);
                        const quantityUsed = finalProductCombination['Pricing Option'] === 'Single' ? quantity : finalProductCombination['Quantity Multiplier'];

                        baseProductPrice = finalProductCombination['Pricing Option'] === 'Single' ? (finalProductCombination.Price * quantity) : finalProductCombination.Price;
                        itemOptions['Quantity'] = quantityUsed; // Ensure cart shows correct quantity used for pricing

                        if (finalProductCombination['Pricing Option'] !== 'Single') {
                             itemOptions['Pricing Breakdown'] = `${finalProductCombination['Pricing Option']} (${finalProductCombination.Price} PKR)`;
                             itemOptions['Effective Unit Price'] = `PKR ${unitPrice.toFixed(2)}`;
                        } else {
                             itemOptions['Pricing Breakdown'] = `${quantity}x Single Print (${finalProductCombination.Price} PKR/ea)`;
                        }

                    } else {
                        // --- STANDARD PRODUCT LOGIC (unchanged) ---
                        baseProductPrice = finalProductCombination.Price * quantity;
                    }
                } else {
                    requiresManualQuote = true;
                }
            }
        }

        if (requiresManualQuote || baseProductPrice === 0) {
            return { error: "Requires manual quote or incomplete selection" };
        }

        // Return core item data (excluding shipping)
        return {
            productName: currentProduct.baseName,
            quantity: itemOptions['Quantity'] || quantity, // Use derived quantity from itemOptions if present
            basePrice: baseProductPrice, // This is the total price for the item(s) before shipping/tax
            options: itemOptions,
            isAreaBased: isAreaBased,
            imageFile: imageFile
        };
    }
    
    // 🛑 NEW: Function to display pricing breakdown for Photo Printing 🛑
    function updatePhotoBundleAlert(itemData, finalProductCombination) {
        const bundleAlert = document.getElementById('photo-bundle-alert');
        if (!bundleAlert || itemData.productName !== "Photo Printing" || !finalProductCombination) {
            return;
        }
        
        // Get the breakdown generated in calculateItemPrice()
        const breakdown = itemData.options['Pricing Breakdown'];
        
        const effectivePricePerUnit = itemData.basePrice / itemData.quantity;

        let alertHtml = '';
        
        if (breakdown) {
            alertHtml += `
                <i class="fas fa-tags me-2"></i> **Pricing Breakdown:**
                <ul class="mt-2 mb-0" style="list-style-type: none; padding-left: 0;">
                    <li class="small">${breakdown}</li>
                    <li class="small fw-bold">Effective Price per Unit: PKR ${effectivePricePerUnit.toFixed(2)}</li>
                </ul>
            `;
            bundleAlert.classList.remove('alert-info', 'alert-danger');
            bundleAlert.classList.add('alert-success');
        } else {
            alertHtml = `Please select both a **Photo Size** and **Pricing Option** above.`;
            bundleAlert.classList.remove('alert-success');
            bundleAlert.classList.add('alert-info');
        }
        
        bundleAlert.innerHTML = alertHtml;
    }

    // 🛑 NEW: Function to display pricing breakdown for Custom Prints 🛑
    function updateCustomPrintsAlert(itemData) {
        const printAlert = document.getElementById('print-price-alert');
        if (!printAlert || itemData.productName !== CUSTOM_PRINTS_PRODUCT_NAME) {
            return;
        }
        
        // Check if the necessary data is present (Tier and Price/Page are set by calculateItemPrice)
        if (itemData.options.Tier && itemData.options['Price/Page']) {
            
            let multiplierInfo = '';
            if (itemData.options.Sides === 'double') {
                multiplierInfo = ' (Double Side: x2 Multiplier)';
                printAlert.classList.remove('alert-info');
                printAlert.classList.add('alert-warning');
            } else {
                printAlert.classList.remove('alert-warning');
                printAlert.classList.add('alert-info');
            }
            
            printAlert.innerHTML = `
                <i class="fas fa-calculator me-2"></i> <strong>Pricing Details:</strong>
                <ul class="mt-2 mb-0" style="list-style-type: none; padding-left: 0;">
                    <li class="small">Pricing Tier: ${itemData.options.Tier}</li>
                    <li class="small">Print Sides: ${itemData.options.Sides}${multiplierInfo}</li>
                    <li class="small fw-bold">Final Price per Page: ${itemData.options['Price/Page']}</li>
                </ul>
            `;
        } else {
            printAlert.innerHTML = 'Select all options and enter a valid quantity (1 to 1000+) to view the price per page.';
            printAlert.classList.remove('alert-success');
            printAlert.classList.add('alert-info');
        }
    }


    // 🛑 NEW: Function to update UI from price calculation (MODIFIED) 🛑
    function updateFinalPrice() {
        const itemData = calculateItemPrice();
        
        // --- Error/Warning Handling ---
        if (itemData.error) {
            document.getElementById('finalPriceBox').style.display = 'none';
            document.getElementById('shipping-display-box').style.display = 'none';
            document.getElementById('selectionWarning').textContent = "Please enter dimensions/quantity or select all options above to see the final price.";
            document.getElementById('selectionWarning').classList.remove('alert-danger');
            document.getElementById('selectionWarning').classList.add('alert-info');
            document.getElementById('selectionWarning').style.display = 'block';
            
            // Clear specific alerts on error
            const bundleAlert = document.getElementById('photo-bundle-alert');
            if (bundleAlert) {
                bundleAlert.innerHTML = 'Please select options and quantity above.';
                bundleAlert.classList.remove('alert-success');
                bundleAlert.classList.add('alert-info');
            }
            const printAlert = document.getElementById('print-price-alert');
            if (printAlert) {
                printAlert.innerHTML = 'Select all options and enter a valid quantity (1 to 1000+) to view the price per page.';
                printAlert.classList.remove('alert-success', 'alert-warning');
                printAlert.classList.add('alert-info');
            }
            return;
        }

        // --- SHIPPING & FINAL PRICE CALCULATION ---
        let shippingCost = 0;
        let shippingNote = '';
        const packetType = getShippingPacketType(itemData.productName);
        
        if (currentDeliveryType === 'SelfPickUp') {
            shippingCost = 0;
            shippingNote = 'Self Pick Up. No shipping charges applied.';
        } else { 
            // Home Delivery Logic
            if (currentShippingZone === 'Within City') {
                shippingCost = SHIPPING_RATES[packetType]['Within City'];
                shippingNote = `Local Delivery (Jalalpur Jattan). Flat rate for ${packetType.toUpperCase()} packet.`;
            } else {
                shippingCost = getPostExShippingCost(packetType, currentShippingZone);
                shippingNote = `PostEx Courier (to ${currentShippingZone}). Price includes ${packetType.toUpperCase()} packet charge, fuel surcharge, and GST.`;
            }
        }

        const totalCost = itemData.basePrice + shippingCost;
        const finalSellingPrice = Math.round(totalCost);
        
        // --- Update UI with Final Selling Price ---
        document.getElementById('finalPriceDisplay').textContent = `PKR ${finalSellingPrice.toLocaleString('en-PK', { minimumFractionDigits: 0 })}`;
        document.getElementById('finalPriceBox').style.display = 'block';
        document.getElementById('selectionWarning').style.display = 'none';

        // 🛑 NEW: Update the specific pricing alerts 🛑
        if (itemData.productName === "Photo Printing" && currentProduct) {
            const requiredKeys = Object.keys(currentProduct.combinations[0] || {}).filter(key => key !== 'Price' && key !== 'FullName' && key !== 'PricingStructure' && key !== 'Quantity Multiplier');
            let finalProductCombination = currentProduct.combinations.find(combo => 
                requiredKeys.every(key => combo[key] === currentSelectedVariations[key])
            );
            updatePhotoBundleAlert(itemData, finalProductCombination);
        } else if (itemData.productName === CUSTOM_PRINTS_PRODUCT_NAME) {
            // 🛑 Custom Prints Alert Call 🛑
            updateCustomPrintsAlert(itemData);
        }
        // 🛑 END NEW INTEGRATION 🛑

        // --- Update UI with Shipping Cost Details ---
        document.getElementById('shipping-cost-display').textContent = shippingCost === 0 ? "FREE" : `PKR ${shippingCost.toLocaleString('en-PK', { minimumFractionDigits: 0 })}`;
        document.getElementById('shipping-note-display').textContent = shippingNote;
        document.getElementById('shipping-display-box').style.display = 'block';

        // Update Area Constraint Warning display (for design fee)
        const areaConstraintWarning = document.getElementById('areaConstraintWarning');
        if (areaConstraintWarning && itemData.isAreaBased) {
             const width = parseFloat(document.getElementById('input-width').value) || 0;
             const height = parseFloat(document.getElementById('input-height').value) || 0;
             const rateMeta = AREA_BASED_META[currentProduct.baseName];
             const minArea = rateMeta ? rateMeta.min_area || 0 : 0;
             const totalArea = width * height * itemData.quantity;

             areaConstraintWarning.classList.remove('alert-danger', 'alert-info');
             areaConstraintWarning.style.display = 'none';

             if (totalArea < minArea && minArea > 0) {
                 areaConstraintWarning.textContent = `Minimum order area for this product is ${minArea} sq ft. Current total area (${totalArea.toFixed(2)} sq ft) is too small.`;
                 areaConstraintWarning.classList.add('alert-danger');
                 areaConstraintWarning.style.display = 'block';
             } else if (itemData.options['Design Service'] === 'DesignNeeded') {
                 const itemArea = width * height;
                 const designFee = calculateDesignFee(itemArea, itemData.quantity);
                 areaConstraintWarning.innerHTML = `<i class="fas fa-magic me-2"></i> **Design Fee Applied**: PKR ${designFee.toLocaleString('en-PK', { minimumFractionDigits: 0 })}`;
                 areaConstraintWarning.classList.add('alert-info');
                 areaConstraintWarning.style.display = 'block';
             }
        }
    }

    // 🛑 NEW: Function to Add Item to Cart (UNCHANGED) 🛑
    function addItemToCart() {
        if (typeof Cart === 'undefined') {
            Cart.showAlert('Cart system not loaded.', 'error');
            return;
        }

        const itemData = calculateItemPrice();
        
        if (itemData.error) {
            Cart.showAlert('Error adding item: ' + itemData.error, 'error');
            return;
        }
        
        const finalPriceDisplay = document.getElementById('finalPriceDisplay').textContent;
        const totalCost = parseFloat(finalPriceDisplay.replace(/PKR|\s|,/g, '')) || 0;

        const cartItem = {
            id: Date.now(), // Unique ID for this cart item
            productName: itemData.productName,
            quantity: itemData.quantity,
            basePrice: itemData.basePrice, 
            finalItemPrice: totalCost, // Total item price including calculated shipping (for immediate display coherence)
            options: itemData.options,
            isAreaBased: itemData.isAreaBased,
            imageFile: itemData.imageFile,
            // Note: Shipping is re-calculated globally on checkout/cart view.
        };

        Cart.addItem(cartItem);
    }

    
    // 4. Navigate to and Populate Product Detail Page (MODIFIED)
    function showProductDetails(productName) {
        
        if (productName.trim() === CUSTOM_PRINTS_PRODUCT_NAME) {
             showDigitalPrintingDetails();
             return;
        }
        if (productName.trim() === "PhotoPapers") {
             productName = "Photo Printing";
        }


        let cleanName = productName.replace(/'/g, '').trim(); 
        const productData = allProductGroups[cleanName]; 
        currentProduct = productData;
        currentSelectedVariations = {}; 

        if (!currentProduct) {
            Cart.showAlert(`Product "${cleanName}" details not found in data. Please use the 'Get Custom Quote' option.`, 'error'); 
            return;
        }

        // Update headers and image
        document.getElementById('detail-product-name-header').textContent = currentProduct.baseName;
        document.getElementById('detail-product-name-body').textContent = currentProduct.baseName;
        
        const imagePath = currentProduct.imageFile;
        document.getElementById('detail-product-image-webp').srcset = `img/products/${imagePath}.webp`;
        document.getElementById('detail-product-image').src = `img/products/${imagePath}.png`; 
        document.getElementById('detail-product-image').onerror = function() { 
             this.src = `img/products/placeholder.png`; 
        };


        const areaInputs = document.getElementById('custom-area-inputs');
        const standardOptions = document.getElementById('standard-options-fields');
        
        document.getElementById('finalPriceBox').style.display = 'none';
        document.getElementById('selectionWarning').textContent = "Please enter dimensions/quantity or select all options above to see the final price.";
        document.getElementById('selectionWarning').classList.remove('alert-danger');
        document.getElementById('selectionWarning').classList.add('alert-info');
        document.getElementById('selectionWarning').style.display = 'block';

        // Reset Delivery Selection to default Home Delivery
        setDeliveryType('HomeDelivery', false); // Initialize UI state and default zone

        const isAreaBased = currentProduct.isAreaBased;
        
        // 🛑 CORE LOGIC: Area-Based vs. Standard 🛑
        if (isAreaBased) {
            // --- AREA-BASED SETUP (Panaflex/Wallpaper/Photo Frames) ---
            areaInputs.style.display = 'block';
            
            // Inject Design Service option group before existing standard options
            standardOptions.style.display = 'block'; 
            standardOptions.innerHTML = `
                <div class="product-option-group" data-option-key="DesignService">
                    <label>Design Service:</label>
                    <div class="d-flex flex-wrap gap-3">
                        <label class="choice-card selected" id="design-printready" 
                               onclick="currentSelectedVariations['DesignService']='PrintReady'; updateFinalPrice()">
                            <input type="radio" name="option-DesignService" value="PrintReady" checked>
                            <span class="label-text">Print Ready File</span>
                        </label>
                        <label class="choice-card" id="design-needed" 
                               onclick="currentSelectedVariations['DesignService']='DesignNeeded'; updateFinalPrice()">
                            <input type="radio" name="option-DesignService" value="DesignNeeded">
                            <span class="label-text">Design Service Required</span>
                        </label>
                    </div>
                </div>`;
            
            // Set initial selection state for the new option
            currentSelectedVariations['DesignService'] = 'PrintReady';

            // Reset Dimension inputs
            document.getElementById('input-width').value = 1;
            document.getElementById('input-height').value = 1;
            document.getElementById('input-custom-qty').value = 1;

            ['input-width', 'input-height', 'input-custom-qty'].forEach(id => {
                 const el = document.getElementById(id);
                 if(el) el.oninput = updateFinalPrice;
            });
            
            document.getElementById('areaConstraintWarning').style.display = 'none';
            document.getElementById('areaConstraintWarning').classList.remove('alert-info');
            document.getElementById('areaConstraintWarning').classList.add('alert-danger'); // Default style is error, use info for fee

            updateFinalPrice();

        } else {
            // --- STANDARD TIERED ITEM SETUP (INCLUDING PHOTO PRINTING) ---
            areaInputs.style.display = 'none';
            standardOptions.style.display = 'block';
            standardOptions.innerHTML = ''; 

            const allCombinations = currentProduct.combinations || [];
            if (allCombinations.length === 0 || !allCombinations[0]) {
                 standardOptions.innerHTML = `<p class="alert alert-warning">No price configurations found for this product. Please use the Quote form.</p>`;
                 return;
            }

            // Exclude internal fields, but keep 'Quantity Multiplier' to manage its value manually
            let attributeKeys = Object.keys(allCombinations[0]).filter(key => 
                key !== 'Price' && key !== 'FullName' && key !== 'PricingStructure' && key !== 'Quantity Multiplier'
            );
            
            // FIX: Sort attribute keys using the defined priority
            attributeKeys = sortAttributeKeys(attributeKeys);


            const availableAttributes = {};
            attributeKeys.forEach(key => availableAttributes[key] = new Set());

            allCombinations.forEach(c => {
                attributeKeys.forEach(key => {
                    if (c[key]) availableAttributes[key].add(c[key]);
                });
            });
            
            // Render groups of unique values for each attribute
            attributeKeys.forEach((attrKey) => {
                const uniqueValues = Array.from(availableAttributes[attrKey]);
                const sanitizedKey = attrKey;

                let groupHTML = `
                    <div class="product-option-group" data-option-key="${sanitizedKey}">
                        <label>${attrKey}:</label>
                        <div class="d-flex flex-wrap gap-3" id="choices-${sanitizedKey}">
                `;
                
                // Sort values for cleaner UI
                uniqueValues.sort((a, b) => a.localeCompare(b, undefined, { numeric: true, sensitivity: 'base' }));

                uniqueValues.forEach(value => {
                    const inputId = `${sanitizedKey}-${value.replace(/\s|\/|\\|\(|\)/g, '-')}`;
                    
                    groupHTML += `
                        <label class="choice-card" for="${inputId}">
                            <input type="radio" id="${inputId}" name="option-${sanitizedKey}" value="${value}" 
                                   onchange="handleCardSelection('${sanitizedKey}', '${value}')">
                            <span class="label-text">${value}</span>
                        </label>
                    `;
                });

                groupHTML += `</div></div>`;
                standardOptions.innerHTML += groupHTML;
            });

            // Add quantity selector for standard items (now controlled by Pricing Option for Photo Printing)
            standardOptions.innerHTML += `
                 <div class="product-option-group" data-option-key="QuantitySelector">
                    <label>Quantity:</label>
                    <div class="input-group">
                        <button class="btn btn-outline-secondary rounded-0" type="button" onclick="updateQuantityStandard(-1)">-</button>
                        <input type="number" id="input-standard-qty" min="1" value="1" class="form-control text-center rounded-0" oninput="updateFinalPrice()">
                        <button class="btn btn-outline-secondary rounded-0" type="button" onclick="updateQuantityStandard(1)">+</button>
                    </div>
                 </div>
                 <div class="alert alert-info mt-3" id="photo-bundle-alert">Please select options and quantity above.</div>
            `;
            
            document.getElementById('finalPriceBox').style.display = 'none';
            document.getElementById('selectionWarning').style.display = 'block';

            // Initial auto-selection to set defaults and trigger cascading update
            if (attributeKeys.length > 0) {
                 const firstKey = attributeKeys[0];
                 const firstValue = Array.from(availableAttributes[firstKey])[0];
                 if(firstValue) {
                    const firstInput = document.querySelector(`input[name="option-${firstKey}"][value="${firstValue}"]`);
                    if(firstInput) firstInput.checked = true;
                    handleCardSelection(firstKey, firstValue);
                 }
            } else {
                updateFinalPrice();
            }
        }

        showSection('product-detail');
    }
    
    // products (13).html - Replacement for showDigitalPrintingDetails function

function showDigitalPrintingDetails() {
    // Ensure the product exists in the derived structure
    currentProduct = allProductGroups[CUSTOM_PRINTS_PRODUCT_NAME];
    currentSelectedVariations = {}; 
    
    if (!currentProduct || !customprintspricing[CUSTOM_PRINTS_PRODUCT_NAME]) {
        Cart.showAlert(`Custom Prints data not found.`, 'error');
        return;
    }

    document.getElementById('detail-product-name-header').textContent = currentProduct.baseName;
    document.getElementById('detail-product-name-body').textContent = currentProduct.baseName;
    
    document.getElementById('detail-product-image-webp').srcset = `img/products/${currentProduct.imageFile}.webp`;
    document.getElementById('detail-product-image').src = `img/products/${currentProduct.imageFile}.png`; 
    document.getElementById('detail-product-image').onerror = function() { this.src = `img/products/placeholder.png`; };

    const areaInputs = document.getElementById('custom-area-inputs');
    const standardOptions = document.getElementById('standard-options-fields');
    
    areaInputs.style.display = 'none';
    standardOptions.style.display = 'block';
    standardOptions.innerHTML = '';
    
    document.getElementById('finalPriceBox').style.display = 'none';
    document.getElementById('selectionWarning').textContent = "Please select all printing options and enter quantity to see the final price.";
    document.getElementById('selectionWarning').classList.remove('alert-danger');
    document.getElementById('selectionWarning').classList.add('alert-info');
    document.getElementById('selectionWarning').style.display = 'block';

    // Reset Delivery Selection to default Home Delivery
    setDeliveryType('HomeDelivery', false); 

    const pricingData = customprintspricing[CUSTOM_PRINTS_PRODUCT_NAME];
    const sizes = Object.keys(pricingData);
    
    if(sizes.length === 0) {
        standardOptions.innerHTML = `<p class="alert alert-warning">Custom Prints not loaded. Please contact support.</p>`;
        showSection('product-detail');
        return;
    }
    
    let html = '';
    // Define the required fields and how to extract options from the nested JSON
    const printOptionsStructure = [
        { key: 'Size', label: 'Size', level: 0 },
        { key: 'ColorType', label: 'Print Color', level: 1 },
        { key: 'GSM', label: 'Paper Weight (GSM)', level: 2 }
    ];
    
    // Add Duplex/Double-sided option (since pricing only accounts for single-sided)
    standardOptions.innerHTML += `
        <div class="product-option-group" data-option-key="Sides">
            <label>Print Sides:</label>
            <div class="d-flex flex-wrap gap-3" id="choices-Sides">
                <label class="choice-card" for="Sides-single">
                    <input type="radio" id="Sides-single" name="option-Sides" value="single" onchange="handleCardSelection('Sides', 'single')">
                    <span class="label-text">Single Side</span>
                </label>
                <label class="choice-card" for="Sides-double">
                    <input type="radio" id="Sides-double" name="option-Sides" value="double" onchange="handleCardSelection('Sides', 'double')">
                    <span class="label-text">Double Side (x2 Price)</span>
                </label>
            </div>
        </div>
    `;

    // Render other options based on nested pricing data
    printOptionsStructure.forEach(option => {
        html += `<div class="product-option-group" data-option-key="${option.key}">
                <label>${option.label}:</label>
                <div class="d-flex flex-wrap gap-3" id="choices-${option.key}">`;
        
        let currentOptions = [];
        if (option.key === 'Size') {
            currentOptions = sizes;
        } else if (option.key === 'ColorType' && sizes.length > 0) {
            // Map internal JSON keys to user-friendly names
            currentOptions = Object.keys(pricingData[sizes[0]] || {}).map(k => k.replace('_', ' '));
        } else if (option.key === 'GSM' && sizes.length > 0) {
            const firstColorType = Object.keys(pricingData[sizes[0]] || {})[0];
            if (firstColorType) {
                currentOptions = Object.keys(pricingData[sizes[0]][firstColorType] || {});
            }
        }

        currentOptions.forEach(value => {
             const displayValue = value.charAt(0).toUpperCase() + value.slice(1);
             // Convert display value back to lowercase/underscore for internal storage
             const storageValue = value.toLowerCase().replace(' ', '_');
             const inputId = `${option.key}-${storageValue}`;
             html += `<label class="choice-card" for="${inputId}">
                         <input type="radio" id="${inputId}" name="option-${option.key}" value="${storageValue}" 
                                onchange="handleCardSelection('${option.key}', '${storageValue}')">
                         <span class="label-text">${displayValue}</span>
                     </label>`;
        });
        html += `</div></div>`;
    });

    standardOptions.innerHTML += html;
    
    // Add Quantity Selector
    standardOptions.innerHTML += `
         <div class="product-option-group" data-option-key="QuantitySelector">
            <label>Number of Pages:</label>
            <div class="input-group">
                <button class="btn btn-outline-secondary rounded-0" type="button" onclick="updateQuantityStandard(-1)">-</button>
                <input type="number" id="input-standard-qty" min="1" value="1" class="form-control text-center rounded-0" oninput="updateFinalPrice()">
                <button class="btn btn-outline-secondary rounded-0" type="button" onclick="updateQuantityStandard(1)">+</button>
            </div>
         </div>
         <div class="alert alert-info mt-3" id="print-price-alert">Select all options and quantity to see the price per page.</div>
    `;
    
    // Initial auto-selection to set defaults
    const initialSelections = {
        'Sides': 'single',
        'Size': sizes[0], // Use original case for keys (A4, Legal)
        'ColorType': Object.keys(pricingData[sizes[0]])[0], // Use original JSON keys (black_white, color)
        'GSM': Object.keys(pricingData[sizes[0]][Object.keys(pricingData[sizes[0]])[0]])[0] // 70g
    };

    // Apply and trigger selections
    Object.keys(initialSelections).forEach(key => {
        const jsonValue = initialSelections[key];
        const input = document.querySelector(`input[name="option-${key}"][value="${jsonValue}"]`);
        if (input) {
            input.checked = true;
            input.closest('.choice-card').classList.add('selected'); // Visually mark as selected
            currentSelectedVariations[key] = jsonValue; // Manually set global variable
        }
    });

    updateFinalPrice();
    
    // 🛑 NEW: Show T&C and Upload section for Custom Prints
    document.getElementById('custom-print-tnc-upload').style.display = 'block';

    showSection('product-detail');
}

    function handleCardSelection(key, value, cascade = true) {
        const sanitizedKey = key;
        
        currentSelectedVariations[sanitizedKey] = value;
        
        document.querySelectorAll(`input[name="option-${sanitizedKey}"]`).forEach(input => {
            input.closest('.choice-card')?.classList.remove('selected');
        });
        const selectedInput = document.querySelector(`input[name="option-${sanitizedKey}"][value="${value}"]`);
        if (selectedInput) {
            selectedInput.closest('.choice-card')?.classList.add('selected');
        }

        if (currentProduct.isDigitalTiered) {
             // For digital tiered pricing, we just need to update the price. No cascading required.
             updateFinalPrice();
             return;
        }

        if (cascade) {
            // Exclude internal fields, but keep 'Quantity Multiplier' to manage its value manually
            let allAttributeKeys = Object.keys(currentProduct.combinations[0]).filter(k => k !== 'Price' && k !== 'FullName' && k !== 'PricingStructure' && k !== 'Quantity Multiplier');
            allAttributeKeys = sortAttributeKeys(allAttributeKeys);

            let startCascade = false;

            for (const attrKey of allAttributeKeys) {
                if (attrKey === key) {
                    startCascade = true;
                    continue; 
                }
                
                if (startCascade) {
                    const targetGroup = document.getElementById(`choices-${attrKey}`);
                    if (targetGroup) {
                        const validValues = filterAvailableOptions(
                            attrKey, currentSelectedVariations, currentProduct.combinations
                        );
                        
                        let newSelectionNeeded = false;
                        
                        targetGroup.querySelectorAll('.choice-card').forEach(card => {
                            const inputEl = card.querySelector('input');
                            const optionValue = inputEl.value;
                            
                            if (!validValues.has(optionValue)) {
                                card.classList.add('disabled');
                                card.classList.remove('selected');
                                
                                if (currentSelectedVariations[attrKey] === optionValue) {
                                    delete currentSelectedVariations[attrKey];
                                    newSelectionNeeded = true;
                                }
                            } else {
                                card.classList.remove('disabled');
                                if (currentSelectedVariations[attrKey] === optionValue) {
                                     card.classList.add('selected');
                                     inputEl.checked = true;
                                }
                            }
                        });
                        
                        if (newSelectionNeeded || !currentSelectedVariations[attrKey]) {
                            const firstValidOption = targetGroup.querySelector('.choice-card:not(.disabled) input');
                            if (firstValidOption) {
                                firstValidOption.checked = true; 
                                handleCardSelection(attrKey, firstValidOption.value);
                                return; 
                            } else {
                                delete currentSelectedVariations[attrKey];
                            }
                        }
                    }
                }
            }
        }
        
        // 🛑 PHOTO PRINTING LOGIC: Update Quantity Input based on Pricing Option selection 🛑
        if (currentProduct.baseName === "Photo Printing" && currentSelectedVariations['Pricing Option']) {
            const selectedOption = currentSelectedVariations['Pricing Option'];
            
            // Find the current active combination to get the multiplier
            const requiredKeysForCombo = Object.keys(currentProduct.combinations[0] || {}).filter(k => k !== 'Price' && k !== 'FullName' && k !== 'PricingStructure' && k !== 'Quantity Multiplier');
            
            const combo = currentProduct.combinations.find(c => 
                requiredKeysForCombo.every(k => c[k] === currentSelectedVariations[k])
            );

            const qtyInput = document.getElementById('input-standard-qty');
            
            if (selectedOption === 'Single') {
                qtyInput.disabled = false;
                qtyInput.min = 1;
                // Ensure Quantity is at least 1 when 'Single' is selected
                if (parseInt(qtyInput.value) < 1) qtyInput.value = 1; 
            } else if (combo && combo['Quantity Multiplier']) {
                // Lock quantity to bundle size
                const newQuantity = combo['Quantity Multiplier'];
                qtyInput.value = newQuantity;
                qtyInput.disabled = true;
            }
        }

        updateFinalPrice();
    }
    
    function filterAvailableOptions(targetKey, currentSelections, allCombinations) {
        const validValues = new Set();
        allCombinations.forEach(combo => {
            let isMatch = true;
            const keysToCheck = Object.keys(currentSelections).filter(k => k !== targetKey);
            
            for (const key of keysToCheck) {
                 if (combo[key] !== currentSelections[key]) {
                    isMatch = false;
                    break;
                 }
            }
            if (isMatch && combo[targetKey]) validValues.add(combo[targetKey]);
        });
        return validValues;
    }

    function updateQuantityStandard(change) {
        const input = document.getElementById('input-standard-qty');
        let quantity = parseInt(input.value) || 1;
        quantity = Math.max(1, quantity + change);
        input.value = quantity;
        updateFinalPrice();
    }
    
    // --- Helper Functions (Remaining) ---
    function handleQuoteSubmission(e) {
        e.preventDefault();
        const name = document.getElementById('quote-name').value;
        const phone = document.getElementById('quote-phone').value;
        const product = document.getElementById('quote-product').value;
        const quantity = document.getElementById('quote-quantity').value;
        const details = document.getElementById('quote-details').value;
        let whatsappMessage = `*NEW QUOTE REQUEST (WEB - PRODUCTS)*\n*Customer:* ${name}\n*Phone (Contact):* ${phone}\n*Product Type:* ${product}\n*Quantity/Area:* ${quantity}\n*Specifications:* ${details}`;
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(whatsappMessage)}`, '_blank');
        Cart.showAlert('Quote submitted via WhatsApp! We will contact you shortly.', 'success');
        document.getElementById('quote-form').reset();
    }
    function handleContactSubmission(e) {
        e.preventDefault();
        const name = document.getElementById('contact-name').value;
        const subject = document.getElementById('contact-subject').value;
        const message = document.getElementById('contact-message').value;
        let whatsappMessage = `*NEW CONTACT MESSAGE (WEB - PRODUCTS)*\n*Sender:* ${name}\n*Subject:* ${subject}\n*Message:* ${message}`;
        window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(whatsappMessage)}`, '_blank');
        Cart.showAlert('Message sent via WhatsApp!', 'success');
        document.getElementById('contact-form-whatsapp').reset();
    }
    function showSection(sectionName) {
        // 🛑 NEW: Hide T&C section by default 🛑
        const tncSection = document.getElementById('custom-print-tnc-upload');
        if (tncSection) tncSection.style.display = 'none';
        
        document.querySelectorAll('.section').forEach(section => { section.classList.remove('active'); });
        const sectionElement = document.getElementById(sectionName + '-section');
        if (sectionElement) sectionElement.classList.add('active'); 
        else document.getElementById('shop-catalog-section').classList.add('active');
        document.querySelectorAll('.navbar-nav .nav-link').forEach(link => { link.classList.remove('active'); });
        const desktopLink = document.querySelector(`.navbar-nav a[onclick="showSection('${sectionName}')"]`);
        if (desktopLink) desktopLink.classList.add('active');
        if (typeof setActiveMobileNav === 'function') setActiveMobileNav(sectionName === 'shop-catalog' ? 'products' : sectionName);
        window.scrollTo(0, 0);

        // Reload cart display on showing cart section
        if (sectionName === 'cart' && typeof Cart !== 'undefined') {
            Cart.updateCartDisplay();
        }
    }
    
    document.addEventListener('DOMContentLoaded', initialAppLoad);
</script>
</div>
</body>

</html>



